<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">{-|
Module      : Tokenizer.Tokenizer
Description : A simple tokenizer for the Hasgull language.

This module provides functionality to tokenize input source code by removing
comments and whitespace, then converting the input into a list of tokens as defined in
'Tokenizer.Token'.
-}</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Tokenizer.Tokenizer</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><a href="Tokenizer.Tokenizer.html#tokenize"><span class="hs-identifier">tokenize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><a href="Tokenizer.Tokenizer.html#stripWhiteSpace"><span class="hs-identifier">stripWhiteSpace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>  </span><span class="annot"><a href="Tokenizer.Tokenizer.html#removeComments"><span class="hs-identifier">removeComments</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><a href="Tokenizer.Tokenizer.html#removeLeadingWhiteSpace"><span class="hs-identifier">removeLeadingWhiteSpace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier">tryReadIdentifierOrReservedWord</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadMultiCharSymbol"><span class="hs-identifier">tryReadMultiCharSymbol</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier">tryReadSymbolToken</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Tokenizer.Tokenizer.html#validLeftOver"><span class="hs-identifier">validLeftOver</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Tokenizer.Tokenizer.html#tokenizeStrippedWords"><span class="hs-identifier">tokenizeStrippedWords</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Tokenizer.Tokenizer.html#tokenizationLoop"><span class="hs-identifier">tokenizationLoop</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Tokenizer.Tokenizer.html#nextToken"><span class="hs-identifier">nextToken</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Tokenizer.Tokenizer.html#handleIdentifierOrReserveWord"><span class="hs-identifier">handleIdentifierOrReserveWord</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Tokenizer.Tokenizer.html#handleNumber"><span class="hs-identifier">handleNumber</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Tokenizer.Tokenizer.html#handleSymbol"><span class="hs-identifier">handleSymbol</span></a></span><span>
</span><span id="line-17"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Tokenizer.Token.html"><span class="hs-identifier">Tokenizer.Token</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier">Token</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="annot"><span class="hs-comment">{-|
Remove line comments from the input.

Cool gimmick we wanted to include in our compiler to be able add comments to our code.
Line comments begin with &quot;//&quot; and continue until the end of the line.
-}</span></span><span>
</span><span id="line-29"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#removeComments"><span class="hs-identifier hs-type">removeComments</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-30"></span><span id="removeComments"><span class="annot"><span class="annottext">removeComments :: String -&gt; String
</span><a href="Tokenizer.Tokenizer.html#removeComments"><span class="hs-identifier hs-var hs-var">removeComments</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-31"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#removeComments"><span class="hs-identifier hs-var">removeComments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679077778"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077778"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="Tokenizer.Tokenizer.html#removeComments"><span class="hs-identifier hs-var">removeComments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; String
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077778"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#removeComments"><span class="hs-identifier hs-var">removeComments</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077781"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077781"><span class="hs-identifier hs-var">keep</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679077782"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077782"><span class="hs-identifier hs-var">check</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077781"><span class="hs-identifier hs-var">keep</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="Tokenizer.Tokenizer.html#removeComments"><span class="hs-identifier hs-var">removeComments</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077782"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="annot"><span class="hs-comment">{-|
Remove leading whitespace from a string.

Drops any space characters ('isSpace') from the beginning of the input.
-}</span></span><span>
</span><span id="line-39"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#removeLeadingWhiteSpace"><span class="hs-identifier hs-type">removeLeadingWhiteSpace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-40"></span><span id="removeLeadingWhiteSpace"><span class="annot"><span class="annottext">removeLeadingWhiteSpace :: String -&gt; String
</span><a href="Tokenizer.Tokenizer.html#removeLeadingWhiteSpace"><span class="hs-identifier hs-var hs-var">removeLeadingWhiteSpace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; String
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="annot"><span class="hs-comment">{-|
Determine if an identifier string corresponds to a reserved word, or should be treated
as a generic identifier.

Recognized reserved words include &quot;Int&quot;, &quot;Void&quot;, &quot;if&quot;, &quot;else&quot;, etc. Any identifier not
matching these is returned as an IdentifierToken.
-}</span></span><span>
</span><span id="line-49"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-type">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-50"></span><span id="tryReadIdentifierOrReservedWord"><span class="annot"><span class="annottext">tryReadIdentifierOrReservedWord :: String -&gt; Token
</span><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var hs-var">tryReadIdentifierOrReservedWord</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Int&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#IntToken"><span class="hs-identifier hs-var">IntToken</span></a></span><span>
</span><span id="line-51"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Void&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#VoidToken"><span class="hs-identifier hs-var">VoidToken</span></a></span><span>
</span><span id="line-52"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Boolean&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#BooleanToken"><span class="hs-identifier hs-var">BooleanToken</span></a></span><span>
</span><span id="line-53"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;if&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#IfToken"><span class="hs-identifier hs-var">IfToken</span></a></span><span>
</span><span id="line-54"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;else&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ElseToken"><span class="hs-identifier hs-var">ElseToken</span></a></span><span>
</span><span id="line-55"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;while&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#WhileToken"><span class="hs-identifier hs-var">WhileToken</span></a></span><span>
</span><span id="line-56"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;return&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ReturnToken"><span class="hs-identifier hs-var">ReturnToken</span></a></span><span>
</span><span id="line-57"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;println&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#PrintLnToken"><span class="hs-identifier hs-var">PrintLnToken</span></a></span><span>
</span><span id="line-58"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;true&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#TrueToken"><span class="hs-identifier hs-var">TrueToken</span></a></span><span>
</span><span id="line-59"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;false&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#FalseToken"><span class="hs-identifier hs-var">FalseToken</span></a></span><span>
</span><span id="line-60"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Self&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SelfToken"><span class="hs-identifier hs-var">SelfToken</span></a></span><span>
</span><span id="line-61"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;self&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LowerCaseSelfToken"><span class="hs-identifier hs-var">LowerCaseSelfToken</span></a></span><span>
</span><span id="line-62"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;func&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#FuncToken"><span class="hs-identifier hs-var">FuncToken</span></a></span><span>
</span><span id="line-63"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;method&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#MethodToken"><span class="hs-identifier hs-var">MethodToken</span></a></span><span>
</span><span id="line-64"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;break&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#BreakToken"><span class="hs-identifier hs-var">BreakToken</span></a></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impl&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ImplToken"><span class="hs-identifier hs-var">ImplToken</span></a></span><span>
</span><span id="line-66"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;let&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LetToken"><span class="hs-identifier hs-var">LetToken</span></a></span><span>
</span><span id="line-67"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;new&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#NewToken"><span class="hs-identifier hs-var">NewToken</span></a></span><span>
</span><span id="line-68"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;trait&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#TraitToken"><span class="hs-identifier hs-var">TraitToken</span></a></span><span>
</span><span id="line-69"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;struct&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#StructToken"><span class="hs-identifier hs-var">StructToken</span></a></span><span>
</span><span id="line-70"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;for&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ForToken"><span class="hs-identifier hs-var">ForToken</span></a></span><span>
</span><span id="line-71"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span id="local-6989586621679077805"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077805"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Token
</span><a href="Tokenizer.Token.html#IdentifierToken"><span class="hs-identifier hs-var">IdentifierToken</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077805"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="annot"><span class="hs-comment">{-|
Attempt to read a multi-character symbol from the input.

Recognized multi-character symbols include:
  * &quot;=&gt;&quot;  becomes ArrowToken
  * &quot;==&quot;  becomes EqualsToken
  * &quot;!=&quot;  becomes NotEqualToken

Returns a tuple of the matching token and the remaining input string, or Nothing if no match.
-}</span></span><span>
</span><span id="line-83"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadMultiCharSymbol"><span class="hs-identifier hs-type">tryReadMultiCharSymbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span id="tryReadMultiCharSymbol"><span class="annot"><span class="annottext">tryReadMultiCharSymbol :: String -&gt; Maybe (Token, String)
</span><a href="Tokenizer.Tokenizer.html#tryReadMultiCharSymbol"><span class="hs-identifier hs-var hs-var">tryReadMultiCharSymbol</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&gt;'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679077807"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077807"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Token, String) -&gt; Maybe (Token, String)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ArrowToken"><span class="hs-identifier hs-var">ArrowToken</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077807"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadMultiCharSymbol"><span class="hs-identifier hs-var">tryReadMultiCharSymbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679077809"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077809"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Token, String) -&gt; Maybe (Token, String)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#EqualsToken"><span class="hs-identifier hs-var">EqualsToken</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077809"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadMultiCharSymbol"><span class="hs-identifier hs-var">tryReadMultiCharSymbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'!'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679077811"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077811"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Token, String) -&gt; Maybe (Token, String)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#NotEqualToken"><span class="hs-identifier hs-var">NotEqualToken</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077811"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadMultiCharSymbol"><span class="hs-identifier hs-var">tryReadMultiCharSymbol</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Token, String)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><span class="hs-comment">{-|
Attempt to read a symbol token from a single character.

Converts characters such as '=' and '+' into their corresponding token variants.
Returns Nothing if the character is not a recognized symbol.
-}</span></span><span>
</span><span id="line-95"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-type">tryReadSymbolToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-96"></span><span id="tryReadSymbolToken"><span class="annot"><span class="annottext">tryReadSymbolToken :: Char -&gt; Maybe Token
</span><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var hs-var">tryReadSymbolToken</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#EqualToken"><span class="hs-identifier hs-var">EqualToken</span></a></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&gt;'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#GreaterThanToken"><span class="hs-identifier hs-var">GreaterThanToken</span></a></span><span>
</span><span id="line-98"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&lt;'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LessThanToken"><span class="hs-identifier hs-var">LessThanToken</span></a></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'+'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#AddToken"><span class="hs-identifier hs-var">AddToken</span></a></span><span>
</span><span id="line-100"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SubtractToken"><span class="hs-identifier hs-var">SubtractToken</span></a></span><span>
</span><span id="line-101"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#MultiplyToken"><span class="hs-identifier hs-var">MultiplyToken</span></a></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#DivideToken"><span class="hs-identifier hs-var">DivideToken</span></a></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LParenToken"><span class="hs-identifier hs-var">LParenToken</span></a></span><span>
</span><span id="line-104"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">')'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RParenToken"><span class="hs-identifier hs-var">RParenToken</span></a></span><span>
</span><span id="line-105"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'{'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LBraceToken"><span class="hs-identifier hs-var">LBraceToken</span></a></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'}'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RBraceToken"><span class="hs-identifier hs-var">RBraceToken</span></a></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#CommaToken"><span class="hs-identifier hs-var">CommaToken</span></a></span><span>
</span><span id="line-108"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ColonToken"><span class="hs-identifier hs-var">ColonToken</span></a></span><span>
</span><span id="line-109"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#DotToken"><span class="hs-identifier hs-var">DotToken</span></a></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">';'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Token
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SemiColonToken"><span class="hs-identifier hs-var">SemiColonToken</span></a></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Token
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><span class="hs-comment">{-|
Strip whitespace from the input string and return a list of words.

Uses the built-in 'words' function to split the input on whitespace.
-}</span></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#stripWhiteSpace"><span class="hs-identifier hs-type">stripWhiteSpace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-119"></span><span id="stripWhiteSpace"><span class="annot"><span class="annottext">stripWhiteSpace :: String -&gt; [String]
</span><a href="Tokenizer.Tokenizer.html#stripWhiteSpace"><span class="hs-identifier hs-var hs-var">stripWhiteSpace</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-120"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#stripWhiteSpace"><span class="hs-identifier hs-var">stripWhiteSpace</span></a></span><span> </span><span id="local-6989586621679077830"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077830"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">words</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077830"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><span class="hs-comment">{-|
Determine if the remaining part of a numerical literal is valid.

A leftover is invalid if it starts with an alphabetic character, indicating an error.
-}</span></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#validLeftOver"><span class="hs-identifier hs-type">validLeftOver</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span>
</span><span id="line-128"></span><span id="validLeftOver"><span class="annot"><span class="annottext">validLeftOver :: String -&gt; Bool
</span><a href="Tokenizer.Tokenizer.html#validLeftOver"><span class="hs-identifier hs-var hs-var">validLeftOver</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-129"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#validLeftOver"><span class="hs-identifier hs-var">validLeftOver</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077831"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077831"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679077832"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077832"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077831"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-131"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-132"></span><span>     </span><span>
</span><span id="line-133"></span><span class="annot"><span class="hs-comment">{-|
Tokenize the input string into a list of tokens.

This function removes comments and whitespace before invoking the tokenization
of individual components.
-}</span></span><span>
</span><span id="line-139"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tokenize"><span class="hs-identifier hs-type">tokenize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-140"></span><span id="tokenize"><span class="annot"><span class="annottext">tokenize :: String -&gt; Either String [Token]
</span><a href="Tokenizer.Tokenizer.html#tokenize"><span class="hs-identifier hs-var hs-var">tokenize</span></a></span></span><span> </span><span id="local-6989586621679077834"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077834"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-141"></span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077835"><span class="annot"><span class="annottext">strippedInput :: [String]
</span><a href="#local-6989586621679077835"><span class="hs-identifier hs-var hs-var">strippedInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><a href="Tokenizer.Tokenizer.html#stripWhiteSpace"><span class="hs-identifier hs-var">stripWhiteSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="Tokenizer.Tokenizer.html#removeComments"><span class="hs-identifier hs-var">removeComments</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077834"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Either String [Token]
</span><a href="Tokenizer.Tokenizer.html#tokenizeStrippedWords"><span class="hs-identifier hs-var">tokenizeStrippedWords</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679077835"><span class="hs-identifier hs-var">strippedInput</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="annot"><span class="hs-comment">{-|
Tokenize a list of whitespace-stripped words into tokens.

Processes each word and concatenates the results.
-}</span></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tokenizeStrippedWords"><span class="hs-identifier hs-type">tokenizeStrippedWords</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span id="tokenizeStrippedWords"><span class="annot"><span class="annottext">tokenizeStrippedWords :: [String] -&gt; Either String [Token]
</span><a href="Tokenizer.Tokenizer.html#tokenizeStrippedWords"><span class="hs-identifier hs-var hs-var">tokenizeStrippedWords</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">[Token] -&gt; Either String [Token]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span>
</span><span id="line-151"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tokenizeStrippedWords"><span class="hs-identifier hs-var">tokenizeStrippedWords</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077836"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077836"><span class="hs-identifier hs-var">word</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077837"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679077837"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-152"></span><span>    </span><span id="local-6989586621679077838"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679077838"><span class="hs-identifier hs-var">tokensfromCurrent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String [Token]
</span><a href="Tokenizer.Tokenizer.html#tokenizationLoop"><span class="hs-identifier hs-var">tokenizationLoop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077836"><span class="hs-identifier hs-var">word</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span id="local-6989586621679077839"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679077839"><span class="hs-identifier hs-var">tokensfromRest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Either String [Token]
</span><a href="Tokenizer.Tokenizer.html#tokenizeStrippedWords"><span class="hs-identifier hs-var">tokenizeStrippedWords</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679077837"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><span class="annottext">[Token] -&gt; Either String [Token]
forall a. a -&gt; Either String a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679077838"><span class="hs-identifier hs-var">tokensfromCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token] -&gt; [Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679077839"><span class="hs-identifier hs-var">tokensfromRest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><span class="hs-comment">{-|
Recursively tokenizes a single string into a list of tokens.

Continues processing until the string is fully consumed.
-}</span></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tokenizationLoop"><span class="hs-identifier hs-type">tokenizationLoop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span id="tokenizationLoop"><span class="annot"><span class="annottext">tokenizationLoop :: String -&gt; Either String [Token]
</span><a href="Tokenizer.Tokenizer.html#tokenizationLoop"><span class="hs-identifier hs-var hs-var">tokenizationLoop</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Either String [Token]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#tokenizationLoop"><span class="hs-identifier hs-var">tokenizationLoop</span></a></span><span> </span><span id="local-6989586621679077840"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077840"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (Token, String)
</span><a href="Tokenizer.Tokenizer.html#nextToken"><span class="hs-identifier hs-var">nextToken</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077840"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679077841"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077841"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String [Token]
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077841"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077842"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077842"><span class="hs-identifier hs-var">currToken</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077843"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077843"><span class="hs-identifier hs-var">restStringList</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077844"><span class="annot"><span class="annottext">stringWithNoSpaceInHeader :: String
</span><a href="#local-6989586621679077844"><span class="hs-identifier hs-var hs-var">stringWithNoSpaceInHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="Tokenizer.Tokenizer.html#removeLeadingWhiteSpace"><span class="hs-identifier hs-var">removeLeadingWhiteSpace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077843"><span class="hs-identifier hs-var">restStringList</span></a></span><span>
</span><span id="line-168"></span><span>      </span><span id="local-6989586621679077845"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679077845"><span class="hs-identifier hs-var">moreTokens</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String [Token]
</span><a href="Tokenizer.Tokenizer.html#tokenizationLoop"><span class="hs-identifier hs-var">tokenizationLoop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077844"><span class="hs-identifier hs-var">stringWithNoSpaceInHeader</span></a></span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><span class="annottext">[Token] -&gt; Either String [Token]
forall a. a -&gt; Either String a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077842"><span class="hs-identifier hs-var">currToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679077845"><span class="hs-identifier hs-var">moreTokens</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="annot"><span class="hs-comment">{-|
Extract the next token from the input string.

Selects the correct handler based on the first character, whether it's alphabetic, numeric, or a symbol.
-}</span></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#nextToken"><span class="hs-identifier hs-type">nextToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span id="nextToken"><span class="annot"><span class="annottext">nextToken :: String -&gt; Either String (Token, String)
</span><a href="Tokenizer.Tokenizer.html#nextToken"><span class="hs-identifier hs-var hs-var">nextToken</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (Token, String)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Input unexpectedly ended&quot;</span></span><span>
</span><span id="line-178"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#nextToken"><span class="hs-identifier hs-var">nextToken</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077846"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077846"><span class="hs-identifier hs-var">firstChar</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679077847"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077847"><span class="hs-identifier hs-var">restOfInputString</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077846"><span class="hs-identifier hs-var">firstChar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Either String (Token, String)
</span><a href="Tokenizer.Tokenizer.html#handleIdentifierOrReserveWord"><span class="hs-identifier hs-var">handleIdentifierOrReserveWord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077846"><span class="hs-identifier hs-var">firstChar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077847"><span class="hs-identifier hs-var">restOfInputString</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077846"><span class="hs-identifier hs-var">firstChar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Either String (Token, String)
</span><a href="Tokenizer.Tokenizer.html#handleNumber"><span class="hs-identifier hs-var">handleNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077846"><span class="hs-identifier hs-var">firstChar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077847"><span class="hs-identifier hs-var">restOfInputString</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (Token, String)
</span><a href="Tokenizer.Tokenizer.html#handleSymbol"><span class="hs-identifier hs-var">handleSymbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077846"><span class="hs-identifier hs-var">firstChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077847"><span class="hs-identifier hs-var">restOfInputString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><span class="hs-comment">{-|
Handle an identifier or reserved word.

Collects alphanumeric characters and returns a token corresponding to either a reserved word or an identifier.
-}</span></span><span>
</span><span id="line-188"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#handleIdentifierOrReserveWord"><span class="hs-identifier hs-type">handleIdentifierOrReserveWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span id="handleIdentifierOrReserveWord"><span class="annot"><span class="annottext">handleIdentifierOrReserveWord :: Char -&gt; String -&gt; Either String (Token, String)
</span><a href="Tokenizer.Tokenizer.html#handleIdentifierOrReserveWord"><span class="hs-identifier hs-var hs-var">handleIdentifierOrReserveWord</span></a></span></span><span> </span><span id="local-6989586621679077849"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077849"><span class="hs-identifier hs-var">firstChar</span></a></span></span><span> </span><span id="local-6989586621679077850"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077850"><span class="hs-identifier hs-var">restOfInputString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077851"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077851"><span class="hs-identifier hs-var">identityBody</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077852"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077852"><span class="hs-identifier hs-var">leftoverString</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlphaNum</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077850"><span class="hs-identifier hs-var">restOfInputString</span></a></span><span>
</span><span id="line-191"></span><span>      </span><span id="local-6989586621679077855"><span class="annot"><span class="annottext">identifier :: String
</span><a href="#local-6989586621679077855"><span class="hs-identifier hs-var hs-var">identifier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077849"><span class="hs-identifier hs-var">firstChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077851"><span class="hs-identifier hs-var">identityBody</span></a></span><span>
</span><span id="line-192"></span><span>      </span><span id="local-6989586621679077856"><span class="annot"><span class="annottext">newToken :: Token
</span><a href="#local-6989586621679077856"><span class="hs-identifier hs-var hs-var">newToken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Token
</span><a href="Tokenizer.Tokenizer.html#tryReadIdentifierOrReservedWord"><span class="hs-identifier hs-var">tryReadIdentifierOrReservedWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077855"><span class="hs-identifier hs-var">identifier</span></a></span><span>
</span><span id="line-193"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Token, String) -&gt; Either String (Token, String)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077856"><span class="hs-identifier hs-var">newToken</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077852"><span class="hs-identifier hs-var">leftoverString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><span class="hs-comment">{-|
Handle a numeric literal from the input.

Reads consecutive digits and checks for invalid trailing characters.
-}</span></span><span>
</span><span id="line-200"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#handleNumber"><span class="hs-identifier hs-type">handleNumber</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span id="handleNumber"><span class="annot"><span class="annottext">handleNumber :: Char -&gt; String -&gt; Either String (Token, String)
</span><a href="Tokenizer.Tokenizer.html#handleNumber"><span class="hs-identifier hs-var hs-var">handleNumber</span></a></span></span><span> </span><span id="local-6989586621679077857"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077857"><span class="hs-identifier hs-var">firstNum</span></a></span></span><span> </span><span id="local-6989586621679077858"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077858"><span class="hs-identifier hs-var">restOfInputString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077859"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077859"><span class="hs-identifier hs-var">numbers</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077860"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077860"><span class="hs-identifier hs-var">leftoverString</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077858"><span class="hs-identifier hs-var">restOfInputString</span></a></span><span>
</span><span id="line-203"></span><span>      </span><span id="local-6989586621679077861"><span class="annot"><span class="annottext">wholeNumber :: String
</span><a href="#local-6989586621679077861"><span class="hs-identifier hs-var hs-var">wholeNumber</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077857"><span class="hs-identifier hs-var">firstNum</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077859"><span class="hs-identifier hs-var">numbers</span></a></span><span>
</span><span id="line-204"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Int
forall a. Read a =&gt; String -&gt; Maybe a
</span><span class="hs-identifier hs-var">readMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077861"><span class="hs-identifier hs-var">wholeNumber</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679077863"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077863"><span class="hs-identifier hs-var">intValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="Tokenizer.Tokenizer.html#validLeftOver"><span class="hs-identifier hs-var">validLeftOver</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077860"><span class="hs-identifier hs-var">leftoverString</span></a></span><span>
</span><span id="line-207"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Token, String) -&gt; Either String (Token, String)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Token
</span><a href="Tokenizer.Token.html#IntegerToken"><span class="hs-identifier hs-var">IntegerToken</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077863"><span class="hs-identifier hs-var">intValue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077860"><span class="hs-identifier hs-var">leftoverString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (Token, String)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid integer: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077861"><span class="hs-identifier hs-var">wholeNumber</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077860"><span class="hs-identifier hs-var">leftoverString</span></a></span><span class="hs-special">)</span><span>      </span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (Token, String)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid integer: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077861"><span class="hs-identifier hs-var">wholeNumber</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="annot"><span class="hs-comment">{-|
Handle symbols from the input string.

First attempts to match multi-character symbols, then falls back to single-character symbol matching.
-}</span></span><span>
</span><span id="line-216"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#handleSymbol"><span class="hs-identifier hs-type">handleSymbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span id="handleSymbol"><span class="annot"><span class="annottext">handleSymbol :: String -&gt; Either String (Token, String)
</span><a href="Tokenizer.Tokenizer.html#handleSymbol"><span class="hs-identifier hs-var hs-var">handleSymbol</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (Token, String)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No input to match symbol.&quot;</span></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Tokenizer.Tokenizer.html#handleSymbol"><span class="hs-identifier hs-var">handleSymbol</span></a></span><span> </span><span id="local-6989586621679077865"><span class="annot"><span class="annottext">wholeString :: String
</span><a href="#local-6989586621679077865"><span class="hs-identifier hs-var">wholeString</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679077866"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077866"><span class="hs-identifier hs-var">firstChar</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679077867"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077867"><span class="hs-identifier hs-var">restOfInputString</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe (Token, String)
</span><a href="Tokenizer.Tokenizer.html#tryReadMultiCharSymbol"><span class="hs-identifier hs-var">tryReadMultiCharSymbol</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077865"><span class="hs-identifier hs-var">wholeString</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077868"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077868"><span class="hs-identifier hs-var">newToken</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077869"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077869"><span class="hs-identifier hs-var">leftoverString</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Token, String) -&gt; Either String (Token, String)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077868"><span class="hs-identifier hs-var">newToken</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077869"><span class="hs-identifier hs-var">leftoverString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Token, String)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Maybe Token
</span><a href="Tokenizer.Tokenizer.html#tryReadSymbolToken"><span class="hs-identifier hs-var">tryReadSymbolToken</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077866"><span class="hs-identifier hs-var">firstChar</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679077870"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077870"><span class="hs-identifier hs-var">newToken</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Token, String) -&gt; Either String (Token, String)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077870"><span class="hs-identifier hs-var">newToken</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077867"><span class="hs-identifier hs-var">restOfInputString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><span class="annottext">Maybe Token
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-225"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; Either String (Token, String)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unrecognized symbol near here `: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077865"><span class="hs-identifier hs-var">wholeString</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;`&quot;</span></span><span class="hs-special">)</span></pre></body></html>