<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE InstanceSigs #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="annot"><span class="hs-comment">{-|
Module      : Generation.Generation
Description : Code generation for the Hasgull programming language.

This section of the module is responsible for emitting JavaScript code for methods
and translating program items (such as struct, implementation, and function definitions)
into their corresponding JavaScript representations.
-}</span></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Generation.Generation</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#generateJS"><span class="hs-identifier">generateJS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#translateFuncDef"><span class="hs-identifier">translateFuncDef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#translateBlock"><span class="hs-identifier">translateBlock</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#translateStmt"><span class="hs-identifier">translateStmt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#translateType"><span class="hs-identifier">translateType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#translateParam"><span class="hs-identifier">translateParam</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier">translateExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#createOutputFile"><span class="hs-identifier">createOutputFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#translateStructParam"><span class="hs-identifier">translateStructParam</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#translateFunc"><span class="hs-identifier">translateFunc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#translateImpl"><span class="hs-identifier">translateImpl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#translateItem"><span class="hs-identifier">translateItem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#wrapBlock"><span class="hs-identifier">wrapBlock</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#indent"><span class="hs-identifier">indent</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Generation.Generation.html#translateIterForLoop"><span class="hs-identifier">translateIterForLoop</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Generation.EnvTable.html#TraitTable"><span class="hs-identifier">TraitTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(\\)</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Generation.EnvTable.html"><span class="hs-identifier">Generation.EnvTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Generation.EnvTable.html#TraitTable"><span class="hs-identifier">TraitTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Generation.EnvTable.html#buildTraitTable"><span class="hs-identifier">buildTraitTable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Parser.AST.html"><span class="hs-identifier">Parser.AST</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readFile</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">writeFile</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="annot"><span class="hs-comment">{- | generateJS: Converts a Program AST to JavaScript.-}</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="annot"><a href="Generation.Generation.html#generateJS"><span class="hs-identifier hs-type">generateJS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-46"></span><span id="generateJS"><span class="annot"><span class="annottext">generateJS :: Program -&gt; String
</span><a href="Generation.Generation.html#generateJS"><span class="hs-identifier hs-var hs-var">generateJS</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span id="local-6989586621679076810"><span class="annot"><span class="annottext">[ProgramItem]
</span><a href="#local-6989586621679076810"><span class="hs-identifier hs-var">items</span></a></span></span><span> </span><span id="local-6989586621679076811"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076811"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-48"></span><span>    </span><span id="local-6989586621679076812"><span class="annot"><span class="annottext">traitTbl :: TraitTable
</span><a href="#local-6989586621679076812"><span class="hs-identifier hs-var hs-var">traitTbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ProgramItem] -&gt; TraitTable
</span><a href="Generation.EnvTable.html#buildTraitTable"><span class="hs-identifier hs-var">buildTraitTable</span></a></span><span> </span><span class="annot"><span class="annottext">[ProgramItem]
</span><a href="#local-6989586621679076810"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span id="local-6989586621679076814"><span class="annot"><span class="annottext">itemJS :: String
</span><a href="#local-6989586621679076814"><span class="hs-identifier hs-var hs-var">itemJS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProgramItem -&gt; String) -&gt; [ProgramItem] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TraitTable -&gt; ProgramItem -&gt; String
</span><a href="Generation.Generation.html#translateItem"><span class="hs-identifier hs-var">translateItem</span></a></span><span> </span><span class="annot"><span class="annottext">TraitTable
</span><a href="#local-6989586621679076812"><span class="hs-identifier hs-var">traitTbl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProgramItem]
</span><a href="#local-6989586621679076810"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span id="local-6989586621679076817"><span class="annot"><span class="annottext">stmtJS :: String
</span><a href="#local-6989586621679076817"><span class="hs-identifier hs-var hs-var">stmtJS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Stmt -&gt; String) -&gt; [Stmt] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; String
</span><a href="Generation.Generation.html#translateStmt"><span class="hs-identifier hs-var">translateStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076811"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-51"></span><span>   </span><span class="hs-keyword">in</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076814"><span class="hs-identifier hs-var">itemJS</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076817"><span class="hs-identifier hs-var">stmtJS</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- generateJS program =</span><span>
</span><span id="line-55"></span><span class="hs-comment">--  let progJS = concatMap translateProgramItem (progItems program)</span><span>
</span><span id="line-56"></span><span class="hs-comment">--     stmtsJS = concatMap translateStmt (progStmts program)</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- in progJS ++ stmtsJS</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- translateProgramItem :: ProgramItem -&gt; String</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- translateProgramItem item = case item of</span><span>
</span><span id="line-61"></span><span class="hs-comment">--  PI_Func funcdef -&gt; translateFuncDef funcdef</span><span>
</span><span id="line-62"></span><span class="hs-comment">--  _ -&gt; &quot;&quot;</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">{-  | translateFuncDef: Translates a FuncDef AST node into a string of an equivalent javascript expression -}</span><span>
</span><span id="line-65"></span><span class="annot"><a href="Generation.Generation.html#translateFuncDef"><span class="hs-identifier hs-type">translateFuncDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#FuncDef"><span class="hs-identifier hs-type">FuncDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-66"></span><span id="translateFuncDef"><span class="annot"><span class="annottext">translateFuncDef :: FuncDef -&gt; String
</span><a href="Generation.Generation.html#translateFuncDef"><span class="hs-identifier hs-var hs-var">translateFuncDef</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.AST.html#FuncDef"><span class="hs-identifier hs-type">FuncDef</span></a></span><span> </span><span id="local-6989586621679076819"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076819"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679076820"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621679076820"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679076821"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679076821"><span class="hs-identifier hs-var">_retType</span></a></span></span><span> </span><span id="local-6989586621679076822"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076822"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;function &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076819"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Param -&gt; String) -&gt; [Param] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Parser.AST.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span> </span><span id="local-6989586621679076824"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076824"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076824"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621679076820"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; String
</span><a href="Generation.Generation.html#translateBlock"><span class="hs-identifier hs-var">translateBlock</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076822"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">{-  | Translates a list of statements into a JavaScript block. -}</span><span>
</span><span id="line-70"></span><span class="annot"><a href="Generation.Generation.html#translateBlock"><span class="hs-identifier hs-type">translateBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-71"></span><span id="translateBlock"><span class="annot"><span class="annottext">translateBlock :: [Stmt] -&gt; String
</span><a href="Generation.Generation.html#translateBlock"><span class="hs-identifier hs-var hs-var">translateBlock</span></a></span></span><span> </span><span id="local-6989586621679076825"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076825"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stmt -&gt; String) -&gt; [Stmt] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; String
</span><a href="Generation.Generation.html#translateStmt"><span class="hs-identifier hs-var">translateStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076825"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- Code Generation stuff</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- Current set Generator. Due to time limitations, we can't exactly handle higher order type for function declarations</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- Or have some of variable checker, it still compiles but it's undefined behavior and in javascript's hands by then.AddToken</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="annot"><span class="hs-comment">{- | Test function to see if we can write the output of a generateJS to a test javascript file-}</span></span><span>
</span><span id="line-80"></span><span class="annot"><a href="Generation.Generation.html#createOutputFile"><span class="hs-identifier hs-type">createOutputFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-81"></span><span id="createOutputFile"><span class="annot"><span class="annottext">createOutputFile :: Program -&gt; String -&gt; IO String
</span><a href="Generation.Generation.html#createOutputFile"><span class="hs-identifier hs-var hs-var">createOutputFile</span></a></span></span><span> </span><span id="local-6989586621679076826"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679076826"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span id="local-6989586621679076827"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076827"><span class="hs-identifier hs-var">outputFilename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679076828"><span class="annot"><span class="annottext">theOutputFile :: String
</span><a href="#local-6989586621679076828"><span class="hs-identifier hs-var hs-var">theOutputFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076827"><span class="hs-identifier hs-var">outputFilename</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.js&quot;</span></span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076828"><span class="hs-identifier hs-var">theOutputFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Program -&gt; String
</span><a href="Generation.Generation.html#generateJS"><span class="hs-identifier hs-var">generateJS</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679076826"><span class="hs-identifier hs-var">output</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Successfully Compilied!&quot;</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">{- | translate an Type AST node into a string of an equivalent javascript expression -}</span></span><span>
</span><span id="line-87"></span><span class="annot"><a href="Generation.Generation.html#translateType"><span class="hs-identifier hs-type">translateType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-88"></span><span id="translateType"><span class="annot"><span class="annottext">translateType :: Type -&gt; String
</span><a href="Generation.Generation.html#translateType"><span class="hs-identifier hs-var hs-var">translateType</span></a></span></span><span> </span><span id="local-6989586621679076829"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679076829"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679076829"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><a href="Parser.AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;number&quot;</span></span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><a href="Parser.AST.html#VoidType"><span class="hs-identifier hs-var">VoidType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;void&quot;</span></span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><a href="Parser.AST.html#BooleanType"><span class="hs-identifier hs-var">BooleanType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;boolean&quot;</span></span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><a href="Parser.AST.html#SelfType"><span class="hs-identifier hs-var">SelfType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;this&quot;</span></span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><a href="Parser.AST.html#StructName"><span class="hs-identifier hs-type">StructName</span></a></span><span> </span><span id="local-6989586621679076835"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076835"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076835"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><a href="Parser.AST.html#HigherOrderType"><span class="hs-identifier hs-type">HigherOrderType</span></a></span><span> </span><span id="local-6989586621679076837"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679076837"><span class="hs-identifier hs-var">types</span></a></span></span><span> </span><span id="local-6989586621679076838"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679076838"><span class="hs-identifier hs-var">returnType</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679076839"><span class="annot"><span class="annottext">typesStr :: String
</span><a href="#local-6989586621679076839"><span class="hs-identifier hs-var hs-var">typesStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; String) -&gt; [Type] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Generation.Generation.html#translateType"><span class="hs-identifier hs-var">translateType</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679076837"><span class="hs-identifier hs-var">types</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Intercalate is used just so we can do type, type, type</span><span>
</span><span id="line-96"></span><span>        </span><span id="local-6989586621679076840"><span class="annot"><span class="annottext">returnTypeStr :: String
</span><a href="#local-6989586621679076840"><span class="hs-identifier hs-var hs-var">returnTypeStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Generation.Generation.html#translateType"><span class="hs-identifier hs-var">translateType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679076838"><span class="hs-identifier hs-var">returnType</span></a></span><span>
</span><span id="line-97"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076839"><span class="hs-identifier hs-var">typesStr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; =&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076840"><span class="hs-identifier hs-var">returnTypeStr</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="annot"><span class="hs-comment">{- | Translate an expression AST node into a string of an equivalent javascript expression -}</span></span><span>
</span><span id="line-101"></span><span class="annot"><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-type">translateExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-102"></span><span id="translateExpr"><span class="annot"><span class="annottext">translateExpr :: Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var hs-var">translateExpr</span></a></span></span><span> </span><span id="local-6989586621679076841"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076841"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076841"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><a href="Parser.AST.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span id="local-6989586621679076843"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076843"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076843"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="Parser.AST.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span id="local-6989586621679076845"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679076845"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679076845"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="Parser.AST.html#Negative"><span class="hs-identifier hs-type">Negative</span></a></span><span> </span><span id="local-6989586621679076848"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076848"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076848"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="Parser.AST.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span id="local-6989586621679076850"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076850"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679076851"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076851"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076850"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076851"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="Parser.AST.html#DotExpr"><span class="hs-identifier hs-type">DotExpr</span></a></span><span> </span><span id="local-6989586621679076853"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076853"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679076854"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076854"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076853"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076854"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="Parser.AST.html#Call"><span class="hs-identifier hs-type">Call</span></a></span><span> </span><span id="local-6989586621679076856"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076856"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679076857"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679076857"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076856"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr -&gt; String) -&gt; [Expr] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679076857"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><a href="Parser.AST.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span id="local-6989586621679076859"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076859"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679076860"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076860"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076859"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076860"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="annottext">Expr
</span><a href="Parser.AST.html#LowerSelf"><span class="hs-identifier hs-var">LowerSelf</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;this&quot;</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><span class="annottext">Expr
</span><a href="Parser.AST.html#Trueish"><span class="hs-identifier hs-var">Trueish</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;true&quot;</span></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">Expr
</span><a href="Parser.AST.html#Falseish"><span class="hs-identifier hs-var">Falseish</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;false&quot;</span></span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><a href="Parser.AST.html#Multiply"><span class="hs-identifier hs-type">Multiply</span></a></span><span> </span><span id="local-6989586621679076865"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076865"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679076866"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076866"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span>
</span><span id="line-114"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679076867"><span class="annot"><span class="annottext">wrap :: Expr -&gt; String
</span><a href="#local-6989586621679076867"><span class="hs-identifier hs-var hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621679076868"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076868"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076868"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-115"></span><span>                        </span><span class="annot"><a href="Parser.AST.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076868"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-116"></span><span>                        </span><span class="annot"><a href="Parser.AST.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076868"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-117"></span><span>                        </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076868"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="#local-6989586621679076867"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076865"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="#local-6989586621679076867"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076866"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><a href="Parser.AST.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span> </span><span id="local-6989586621679076870"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076870"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679076871"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076871"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679076872"><span class="annot"><span class="annottext">wrap :: Expr -&gt; String
</span><a href="#local-6989586621679076872"><span class="hs-identifier hs-var hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621679076873"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076873"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076873"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-121"></span><span>                        </span><span class="annot"><a href="Parser.AST.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076873"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-122"></span><span>                        </span><span class="annot"><a href="Parser.AST.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076873"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-123"></span><span>                        </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076873"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="#local-6989586621679076872"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076870"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="#local-6989586621679076872"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076871"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="Parser.AST.html#Equals"><span class="hs-identifier hs-type">Equals</span></a></span><span> </span><span id="local-6989586621679076875"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076875"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679076876"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076876"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076875"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;===&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076876"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="Parser.AST.html#NotEquals"><span class="hs-identifier hs-type">NotEquals</span></a></span><span> </span><span id="local-6989586621679076878"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076878"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679076879"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076879"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076878"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!==&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076879"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="Parser.AST.html#GreaterThan"><span class="hs-identifier hs-type">GreaterThan</span></a></span><span> </span><span id="local-6989586621679076881"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076881"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679076882"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076882"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076881"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076882"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><a href="Parser.AST.html#LessThan"><span class="hs-identifier hs-type">LessThan</span></a></span><span> </span><span id="local-6989586621679076884"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076884"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679076885"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076885"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076884"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076885"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><a href="Parser.AST.html#NewStruct"><span class="hs-identifier hs-type">NewStruct</span></a></span><span> </span><span id="local-6989586621679076887"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679076887"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679076888"><span class="annot"><span class="annottext">[StructActualParam]
</span><a href="#local-6989586621679076888"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;new &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Generation.Generation.html#translateType"><span class="hs-identifier hs-var">translateType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679076887"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StructActualParam -&gt; String) -&gt; [StructActualParam] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">StructActualParam -&gt; String
</span><a href="Generation.Generation.html#translateStructParam"><span class="hs-identifier hs-var">translateStructParam</span></a></span><span> </span><span class="annot"><span class="annottext">[StructActualParam]
</span><a href="#local-6989586621679076888"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><span class="hs-comment">{- | Translate a StructActualParam AST node into a string of an equivalent javascript expression -}</span></span><span>
</span><span id="line-132"></span><span class="annot"><a href="Generation.Generation.html#translateStructParam"><span class="hs-identifier hs-type">translateStructParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#StructActualParam"><span class="hs-identifier hs-type">StructActualParam</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-133"></span><span id="translateStructParam"><span class="annot"><span class="annottext">translateStructParam :: StructActualParam -&gt; String
</span><a href="Generation.Generation.html#translateStructParam"><span class="hs-identifier hs-var hs-var">translateStructParam</span></a></span></span><span> </span><span id="local-6989586621679076889"><span class="annot"><span class="annottext">StructActualParam
</span><a href="#local-6989586621679076889"><span class="hs-identifier hs-var">sparam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StructActualParam
</span><a href="#local-6989586621679076889"><span class="hs-identifier hs-var">sparam</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><a href="Parser.AST.html#StructActualParam"><span class="hs-identifier hs-type">StructActualParam</span></a></span><span> </span><span id="local-6989586621679076891"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076891"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679076892"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076892"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076892"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="annot"><span class="hs-comment">{- | Translate a Param AST node into a string of an equivalent javascript expression -}</span></span><span>
</span><span id="line-137"></span><span class="annot"><a href="Generation.Generation.html#translateParam"><span class="hs-identifier hs-type">translateParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-138"></span><span id="translateParam"><span class="annot"><span class="annottext">translateParam :: Param -&gt; String
</span><a href="Generation.Generation.html#translateParam"><span class="hs-identifier hs-var hs-var">translateParam</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.AST.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span> </span><span id="local-6989586621679076893"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076893"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679076894"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679076894"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-comment">-- Since we are converting to javascript, then why would we include the type? The paraser should already have done the check on typing</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076893"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="annot"><span class="hs-comment">{- | Wraps a block statement in curly braces-}</span></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Generation.Generation.html#wrapBlock"><span class="hs-identifier hs-type">wrapBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-144"></span><span id="wrapBlock"><span class="annot"><span class="annottext">wrapBlock :: Stmt -&gt; String
</span><a href="Generation.Generation.html#wrapBlock"><span class="hs-identifier hs-var hs-var">wrapBlock</span></a></span></span><span> </span><span id="local-6989586621679076895"><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076895"><span class="hs-identifier hs-var">stmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076895"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><a href="Parser.AST.html#BlockStmt"><span class="hs-identifier hs-type">BlockStmt</span></a></span><span> </span><span id="local-6989586621679076897"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076897"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; String
</span><a href="Generation.Generation.html#translateBlock"><span class="hs-identifier hs-var">translateBlock</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076897"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><span class="annottext">Stmt
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; String
</span><a href="Generation.Generation.html#translateStmt"><span class="hs-identifier hs-var">translateStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076895"><span class="hs-identifier hs-var">stmt</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><span class="hs-comment">{- |Helper function for the assgStmt in the For Loop-}</span></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Generation.Generation.html#translateIterForLoop"><span class="hs-identifier hs-type">translateIterForLoop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-151"></span><span id="translateIterForLoop"><span class="annot"><span class="annottext">translateIterForLoop :: Stmt -&gt; String
</span><a href="Generation.Generation.html#translateIterForLoop"><span class="hs-identifier hs-var hs-var">translateIterForLoop</span></a></span></span><span> </span><span id="local-6989586621679076898"><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076898"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076898"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><a href="Parser.AST.html#AssgStmt"><span class="hs-identifier hs-type">AssgStmt</span></a></span><span> </span><span id="local-6989586621679076900"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076900"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679076901"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076901"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076900"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076901"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><span class="annottext">Stmt
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;err&quot;</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><span class="hs-comment">{- | Translate a Stmt AST node into a string of an equivalent javascript expression-}</span></span><span>
</span><span id="line-156"></span><span class="annot"><a href="Generation.Generation.html#translateStmt"><span class="hs-identifier hs-type">translateStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-157"></span><span id="translateStmt"><span class="annot"><span class="annottext">translateStmt :: Stmt -&gt; String
</span><a href="Generation.Generation.html#translateStmt"><span class="hs-identifier hs-var hs-var">translateStmt</span></a></span></span><span> </span><span id="local-6989586621679076902"><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076902"><span class="hs-identifier hs-var">stmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076902"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><span class="annottext">Stmt
</span><a href="Parser.AST.html#BreakStmt"><span class="hs-identifier hs-var">BreakStmt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;break;&quot;</span></span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><a href="Parser.AST.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span id="local-6989586621679076905"><span class="annot"><span class="annottext">Param
</span><a href="#local-6989586621679076905"><span class="hs-identifier hs-var">param</span></a></span></span><span> </span><span id="local-6989586621679076906"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076906"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;let&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Param -&gt; String
</span><a href="Generation.Generation.html#translateParam"><span class="hs-identifier hs-var">translateParam</span></a></span><span> </span><span class="annot"><span class="annottext">Param
</span><a href="#local-6989586621679076905"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076906"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;;&quot;</span></span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><a href="Parser.AST.html#AssgStmt"><span class="hs-identifier hs-type">AssgStmt</span></a></span><span> </span><span id="local-6989586621679076907"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076907"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679076908"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076908"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076907"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076908"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;; &quot;</span></span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><a href="Parser.AST.html#BlockStmt"><span class="hs-identifier hs-type">BlockStmt</span></a></span><span> </span><span id="local-6989586621679076909"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076909"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; String
</span><a href="Generation.Generation.html#translateBlock"><span class="hs-identifier hs-var">translateBlock</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076909"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><a href="Parser.AST.html#WhileStmt"><span class="hs-identifier hs-type">WhileStmt</span></a></span><span> </span><span id="local-6989586621679076911"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076911"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679076912"><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076912"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;while(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076911"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; String
</span><a href="Generation.Generation.html#wrapBlock"><span class="hs-identifier hs-var">wrapBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076912"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="Parser.AST.html#IfStmt"><span class="hs-identifier hs-type">IfStmt</span></a></span><span> </span><span id="local-6989586621679076914"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076914"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679076915"><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076915"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679076916"><span class="annot"><span class="annottext">Maybe Stmt
</span><a href="#local-6989586621679076916"><span class="hs-identifier hs-var">maybeElse</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;if( &quot;</span></span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076914"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-166"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) &quot;</span></span><span>
</span><span id="line-167"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; String
</span><a href="Generation.Generation.html#wrapBlock"><span class="hs-identifier hs-var">wrapBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076915"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-168"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Stmt
</span><a href="#local-6989586621679076916"><span class="hs-identifier hs-var">maybeElse</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679076917"><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076917"><span class="hs-identifier hs-var">elseStmt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; else &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; String
</span><a href="Generation.Generation.html#wrapBlock"><span class="hs-identifier hs-var">wrapBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076917"><span class="hs-identifier hs-var">elseStmt</span></a></span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">Maybe Stmt
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><a href="Parser.AST.html#ForStmt"><span class="hs-identifier hs-type">ForStmt</span></a></span><span> </span><span id="local-6989586621679076919"><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076919"><span class="hs-identifier hs-var">initS</span></a></span></span><span> </span><span id="local-6989586621679076920"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076920"><span class="hs-identifier hs-var">evalute</span></a></span></span><span> </span><span id="local-6989586621679076921"><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076921"><span class="hs-identifier hs-var">update</span></a></span></span><span> </span><span id="local-6989586621679076922"><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076922"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;for(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; String
</span><a href="Generation.Generation.html#translateStmt"><span class="hs-identifier hs-var">translateStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076919"><span class="hs-identifier hs-var">initS</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076920"><span class="hs-identifier hs-var">evalute</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; ; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; String
</span><a href="Generation.Generation.html#translateIterForLoop"><span class="hs-identifier hs-var">translateIterForLoop</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076921"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; String
</span><a href="Generation.Generation.html#wrapBlock"><span class="hs-identifier hs-var">wrapBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679076922"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><a href="Parser.AST.html#ReturnStmt"><span class="hs-identifier hs-type">ReturnStmt</span></a></span><span> </span><span id="local-6989586621679076924"><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679076924"><span class="hs-identifier hs-var">maybeExpr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;return &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679076924"><span class="hs-identifier hs-var">maybeExpr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679076925"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076925"><span class="hs-identifier hs-var">reExpr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076925"><span class="hs-identifier hs-var">reExpr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-176"></span><span>      </span><span class="annot"><span class="annottext">Maybe Expr
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;;&quot;</span></span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><a href="Parser.AST.html#PrintLnStmt"><span class="hs-identifier hs-type">PrintLnStmt</span></a></span><span> </span><span id="local-6989586621679076927"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076927"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;console.log(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076927"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;;&quot;</span></span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><a href="Parser.AST.html#ExprStmt"><span class="hs-identifier hs-type">ExprStmt</span></a></span><span> </span><span id="local-6989586621679076929"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076929"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Generation.Generation.html#translateExpr"><span class="hs-identifier hs-var">translateExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679076929"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;;&quot;</span></span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><span class="annottext">Stmt
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;How did you get here?&quot;</span></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="annot"><span class="hs-comment">{- | Indent Helper function-}</span></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Generation.Generation.html#indent"><span class="hs-identifier hs-type">indent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-183"></span><span id="indent"><span class="annot"><span class="annottext">indent :: Int -&gt; String -&gt; String
</span><a href="Generation.Generation.html#indent"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span> </span><span id="local-6989586621679076930"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679076930"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679076931"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076931"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679076930"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076931"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="annot"><span class="hs-comment">{- | Translates a StructDef AST node into a string of an equivalent javascript-}</span></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Generation.Generation.html#translateStruct"><span class="hs-identifier hs-type">translateStruct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#StructDef"><span class="hs-identifier hs-type">StructDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-187"></span><span id="translateStruct"><span class="annot"><span class="annottext">translateStruct :: StructDef -&gt; String
</span><a href="Generation.Generation.html#translateStruct"><span class="hs-identifier hs-var hs-var">translateStruct</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.AST.html#StructDef"><span class="hs-identifier hs-type">StructDef</span></a></span><span> </span><span id="local-6989586621679076936"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076936"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679076937"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621679076937"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-comment">-- extract field names</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="#local-6989586621679076938"><span class="hs-identifier hs-type">fieldNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679076938"><span class="annot"><span class="annottext">fieldNames :: [String]
</span><a href="#local-6989586621679076938"><span class="hs-identifier hs-var hs-var">fieldNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076939"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Parser.AST.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span> </span><span id="local-6989586621679076939"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076939"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621679076937"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-comment">-- header and constructor</span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679076940"><span class="annot"><span class="annottext">header :: String
</span><a href="#local-6989586621679076940"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;class &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076936"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; {\n&quot;</span></span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621679076941"><span class="annot"><span class="annottext">consArgs :: String
</span><a href="#local-6989586621679076941"><span class="hs-identifier hs-var hs-var">consArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679076938"><span class="hs-identifier hs-var">fieldNames</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621679076942"><span class="annot"><span class="annottext">consStart :: String
</span><a href="#local-6989586621679076942"><span class="hs-identifier hs-var hs-var">consStart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
</span><a href="Generation.Generation.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;constructor(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076941"><span class="hs-identifier hs-var">consArgs</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) {&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-comment">-- one assignment per field</span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621679076944"><span class="annot"><span class="annottext">assigns :: String
</span><a href="#local-6989586621679076944"><span class="hs-identifier hs-var hs-var">assigns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>      </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span>
</span><span id="line-201"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679076945"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076945"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
</span><a href="Generation.Generation.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;this.&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076945"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076945"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679076938"><span class="hs-identifier hs-var">fieldNames</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>    </span><span id="local-6989586621679076946"><span class="annot"><span class="annottext">consEnd :: String
</span><a href="#local-6989586621679076946"><span class="hs-identifier hs-var hs-var">consEnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
</span><a href="Generation.Generation.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}\n&quot;</span></span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621679076947"><span class="annot"><span class="annottext">footer :: String
</span><a href="#local-6989586621679076947"><span class="hs-identifier hs-var hs-var">footer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}\n\n&quot;</span></span><span>
</span><span id="line-206"></span><span>   </span><span class="hs-keyword">in</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076940"><span class="hs-identifier hs-var">header</span></a></span><span>
</span><span id="line-208"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076942"><span class="hs-identifier hs-var">consStart</span></a></span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076944"><span class="hs-identifier hs-var">assigns</span></a></span><span>
</span><span id="line-210"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076946"><span class="hs-identifier hs-var">consEnd</span></a></span><span>
</span><span id="line-211"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076947"><span class="hs-identifier hs-var">footer</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><span class="hs-comment">{- | Translates a StructDef AST node into a string of an equivalent javascript-}</span></span><span>
</span><span id="line-214"></span><span class="annot"><a href="Generation.Generation.html#translateFunc"><span class="hs-identifier hs-type">translateFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#FuncDef"><span class="hs-identifier hs-type">FuncDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-215"></span><span id="translateFunc"><span class="annot"><span class="annottext">translateFunc :: FuncDef -&gt; String
</span><a href="Generation.Generation.html#translateFunc"><span class="hs-identifier hs-var hs-var">translateFunc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.AST.html#FuncDef"><span class="hs-identifier hs-type">FuncDef</span></a></span><span> </span><span id="local-6989586621679076948"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076948"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679076949"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621679076949"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679076950"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076950"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621679076951"><span class="annot"><span class="annottext">paramList :: String
</span><a href="#local-6989586621679076951"><span class="hs-identifier hs-var hs-var">paramList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076952"><span class="hs-identifier hs-var">pname</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Parser.AST.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span> </span><span id="local-6989586621679076952"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076952"><span class="hs-identifier hs-var">pname</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621679076949"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span>    </span><span id="local-6989586621679076953"><span class="annot"><span class="annottext">header :: String
</span><a href="#local-6989586621679076953"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;function &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076948"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076951"><span class="hs-identifier hs-var">paramList</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) {&quot;</span></span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621679076955"><span class="annot"><span class="annottext">stmts :: String
</span><a href="#local-6989586621679076955"><span class="hs-identifier hs-var hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Stmt -&gt; String) -&gt; [Stmt] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; String
</span><a href="Generation.Generation.html#translateStmt"><span class="hs-identifier hs-var">translateStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076950"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679076956"><span class="annot"><span class="annottext">footer :: String
</span><a href="#local-6989586621679076956"><span class="hs-identifier hs-var hs-var">footer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-221"></span><span>   </span><span class="hs-keyword">in</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076953"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076955"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076956"><span class="hs-identifier hs-var">footer</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- Maps a Hasgull Type to its JavaScript constructor/prototype base</span><span>
</span><span id="line-226"></span><span class="annot"><a href="Generation.Generation.html#jsConstructorName"><span class="hs-identifier hs-type">jsConstructorName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-227"></span><span id="jsConstructorName"><span class="annot"><span class="annottext">jsConstructorName :: Type -&gt; Maybe String
</span><a href="Generation.Generation.html#jsConstructorName"><span class="hs-identifier hs-var hs-var">jsConstructorName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><a href="Parser.AST.html#StructName"><span class="hs-identifier hs-type">StructName</span></a></span><span> </span><span id="local-6989586621679076958"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076958"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076958"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><a href="Parser.AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Number&quot;</span></span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><a href="Parser.AST.html#BooleanType"><span class="hs-identifier hs-var">BooleanType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Boolean&quot;</span></span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-comment">-- Emit a prototype method assignment for a type</span><span>
</span><span id="line-234"></span><span class="annot"><a href="Generation.Generation.html#emitMethod"><span class="hs-identifier hs-type">emitMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Parser.AST.html#ConcMethodDef"><span class="hs-identifier hs-type">ConcMethodDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-235"></span><span id="emitMethod"><span class="annot"><span class="annottext">emitMethod :: Type -&gt; ConcMethodDef -&gt; String
</span><a href="Generation.Generation.html#emitMethod"><span class="hs-identifier hs-var hs-var">emitMethod</span></a></span></span><span> </span><span id="local-6989586621679076960"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679076960"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.AST.html#ConcMethodDef"><span class="hs-identifier hs-type">ConcMethodDef</span></a></span><span> </span><span id="local-6989586621679076962"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076962"><span class="hs-identifier hs-var">mName</span></a></span></span><span> </span><span id="local-6989586621679076963"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621679076963"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679076964"><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076964"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe String
</span><a href="Generation.Generation.html#jsConstructorName"><span class="hs-identifier hs-var">jsConstructorName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679076960"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679076965"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076965"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-239"></span><span>        </span><span id="local-6989586621679076966"><span class="annot"><span class="annottext">args :: String
</span><a href="#local-6989586621679076966"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076967"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Parser.AST.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span> </span><span id="local-6989586621679076967"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076967"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621679076963"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-240"></span><span>        </span><span id="local-6989586621679076968"><span class="annot"><span class="annottext">header :: String
</span><a href="#local-6989586621679076968"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076965"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.prototype.&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076962"><span class="hs-identifier hs-var">mName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = function(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076966"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) {&quot;</span></span><span>
</span><span id="line-241"></span><span>        </span><span id="local-6989586621679076970"><span class="annot"><span class="annottext">stmts :: String
</span><a href="#local-6989586621679076970"><span class="hs-identifier hs-var hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Stmt -&gt; String) -&gt; [Stmt] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; String
</span><a href="Generation.Generation.html#translateStmt"><span class="hs-identifier hs-var">translateStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679076964"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-242"></span><span>        </span><span id="local-6989586621679076971"><span class="annot"><span class="annottext">footer :: String
</span><a href="#local-6989586621679076971"><span class="hs-identifier hs-var hs-var">footer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;};&quot;</span></span><span>
</span><span id="line-243"></span><span>       </span><span class="hs-keyword">in</span><span>
</span><span id="line-244"></span><span>        </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076968"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076970"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076971"><span class="hs-identifier hs-var">footer</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><span class="hs-comment">{- | 'translateImpl' translates an implementation definition ('ImplDef') into its -}</span></span><span>
</span><span id="line-249"></span><span class="annot"><a href="Generation.Generation.html#translateImpl"><span class="hs-identifier hs-type">translateImpl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Generation.EnvTable.html#TraitTable"><span class="hs-identifier hs-type">TraitTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Parser.AST.html#ImplDef"><span class="hs-identifier hs-type">ImplDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-250"></span><span id="translateImpl"><span class="annot"><span class="annottext">translateImpl :: TraitTable -&gt; ImplDef -&gt; String
</span><a href="Generation.Generation.html#translateImpl"><span class="hs-identifier hs-var hs-var">translateImpl</span></a></span></span><span> </span><span id="local-6989586621679076973"><span class="annot"><span class="annottext">TraitTable
</span><a href="#local-6989586621679076973"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.AST.html#ImplDef"><span class="hs-identifier hs-type">ImplDef</span></a></span><span> </span><span id="local-6989586621679076974"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076974"><span class="hs-identifier hs-var">traitName</span></a></span></span><span> </span><span id="local-6989586621679076975"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679076975"><span class="hs-identifier hs-var">forType</span></a></span></span><span> </span><span id="local-6989586621679076976"><span class="annot"><span class="annottext">[ConcMethodDef]
</span><a href="#local-6989586621679076976"><span class="hs-identifier hs-var">methods</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; TraitTable -&gt; Maybe [AbsMethodDef]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076974"><span class="hs-identifier hs-var">traitName</span></a></span><span> </span><span class="annot"><span class="annottext">TraitTable
</span><a href="#local-6989586621679076973"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><span class="annottext">Maybe [AbsMethodDef]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; String
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unknown trait: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076974"><span class="hs-identifier hs-var">traitName</span></a></span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679076979"><span class="annot"><span class="annottext">[AbsMethodDef]
</span><a href="#local-6989586621679076979"><span class="hs-identifier hs-var">absMeths</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-255"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-256"></span><span>        </span><span id="local-6989586621679076980"><span class="annot"><span class="annottext">required :: [String]
</span><a href="#local-6989586621679076980"><span class="hs-identifier hs-var hs-var">required</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076981"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Parser.AST.html#AbsMethodDef"><span class="hs-identifier hs-type">AbsMethodDef</span></a></span><span> </span><span id="local-6989586621679076981"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076981"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[AbsMethodDef]
</span><a href="#local-6989586621679076979"><span class="hs-identifier hs-var">absMeths</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-257"></span><span>        </span><span id="local-6989586621679076983"><span class="annot"><span class="annottext">provided :: [String]
</span><a href="#local-6989586621679076983"><span class="hs-identifier hs-var hs-var">provided</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076984"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Parser.AST.html#ConcMethodDef"><span class="hs-identifier hs-type">ConcMethodDef</span></a></span><span> </span><span id="local-6989586621679076984"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076984"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ConcMethodDef]
</span><a href="#local-6989586621679076976"><span class="hs-identifier hs-var">methods</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-258"></span><span>        </span><span id="local-6989586621679076989"><span class="annot"><span class="annottext">missing :: [String]
</span><a href="#local-6989586621679076989"><span class="hs-identifier hs-var hs-var">missing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679076980"><span class="hs-identifier hs-var">required</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679076983"><span class="hs-identifier hs-var">provided</span></a></span><span>
</span><span id="line-259"></span><span>       </span><span class="hs-keyword">in</span><span>
</span><span id="line-260"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679076989"><span class="hs-identifier hs-var">missing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>          </span><span class="hs-keyword">then</span><span>
</span><span id="line-262"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; String
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-263"></span><span>              </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Impl for trait \&quot;&quot;</span></span><span>
</span><span id="line-264"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076974"><span class="hs-identifier hs-var">traitName</span></a></span><span>
</span><span id="line-265"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&quot; on &quot;</span></span><span>
</span><span id="line-266"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679076975"><span class="hs-identifier hs-var">forType</span></a></span><span>
</span><span id="line-267"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; is missing methods: &quot;</span></span><span>
</span><span id="line-268"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679076989"><span class="hs-identifier hs-var">missing</span></a></span><span>
</span><span id="line-269"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(ConcMethodDef -&gt; String) -&gt; [ConcMethodDef] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; ConcMethodDef -&gt; String
</span><a href="Generation.Generation.html#emitMethod"><span class="hs-identifier hs-var">emitMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679076975"><span class="hs-identifier hs-var">forType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ConcMethodDef]
</span><a href="#local-6989586621679076976"><span class="hs-identifier hs-var">methods</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><span class="hs-comment">{-|
'translateItem' translates a top-level program item ('ProgramItem') into its 
JavaScript equivalent. Depending on the type of program item it dispatches to
the appropriate translation function.
-}</span></span><span>
</span><span id="line-276"></span><span class="annot"><a href="Generation.Generation.html#translateItem"><span class="hs-identifier hs-type">translateItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Generation.EnvTable.html#TraitTable"><span class="hs-identifier hs-type">TraitTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Parser.AST.html#ProgramItem"><span class="hs-identifier hs-type">ProgramItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-277"></span><span id="translateItem"><span class="annot"><span class="annottext">translateItem :: TraitTable -&gt; ProgramItem -&gt; String
</span><a href="Generation.Generation.html#translateItem"><span class="hs-identifier hs-var hs-var">translateItem</span></a></span></span><span> </span><span id="local-6989586621679076992"><span class="annot"><span class="annottext">TraitTable
</span><a href="#local-6989586621679076992"><span class="hs-identifier hs-var">traitTbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><a href="Parser.AST.html#PI_Struct"><span class="hs-identifier hs-type">PI_Struct</span></a></span><span> </span><span id="local-6989586621679076994"><span class="annot"><span class="annottext">StructDef
</span><a href="#local-6989586621679076994"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StructDef -&gt; String
</span><a href="Generation.Generation.html#translateStruct"><span class="hs-identifier hs-var">translateStruct</span></a></span><span> </span><span class="annot"><span class="annottext">StructDef
</span><a href="#local-6989586621679076994"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><a href="Parser.AST.html#PI_Trait"><span class="hs-identifier hs-type">PI_Trait</span></a></span><span> </span><span class="annot"><span class="annottext">TraitDef
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-comment">-- will fill in later</span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><a href="Parser.AST.html#PI_Impl"><span class="hs-identifier hs-type">PI_Impl</span></a></span><span> </span><span id="local-6989586621679076997"><span class="annot"><span class="annottext">ImplDef
</span><a href="#local-6989586621679076997"><span class="hs-identifier hs-var">impl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TraitTable -&gt; ImplDef -&gt; String
</span><a href="Generation.Generation.html#translateImpl"><span class="hs-identifier hs-var">translateImpl</span></a></span><span> </span><span class="annot"><span class="annottext">TraitTable
</span><a href="#local-6989586621679076992"><span class="hs-identifier hs-var">traitTbl</span></a></span><span> </span><span class="annot"><span class="annottext">ImplDef
</span><a href="#local-6989586621679076997"><span class="hs-identifier hs-var">impl</span></a></span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><a href="Parser.AST.html#PI_Func"><span class="hs-identifier hs-type">PI_Func</span></a></span><span> </span><span id="local-6989586621679076999"><span class="annot"><span class="annottext">FuncDef
</span><a href="#local-6989586621679076999"><span class="hs-identifier hs-var">func</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FuncDef -&gt; String
</span><a href="Generation.Generation.html#translateFunc"><span class="hs-identifier hs-var">translateFunc</span></a></span><span> </span><span class="annot"><span class="annottext">FuncDef
</span><a href="#local-6989586621679076999"><span class="hs-identifier hs-var">func</span></a></span><span>
</span><span id="line-282"></span></pre></body></html>