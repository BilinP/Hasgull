<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Parser.Parser</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Description : Parsers for the Hasgull programming language.</span><span>
</span><span id="line-4"></span><span class="hs-comment">--</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- This module provides parsers for expressions, types, parameters, statements, and</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- program structures used in the Hasgull language. It also includes parsers for trait,</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- struct, implementation, and function definitions.</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Parser.Parser</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Combinators.Expr</span></span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Hide Token to avoid ambiguity</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Void</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Parser.AST.html"><span class="hs-identifier">Parser.AST</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Token</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">many</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec.Char</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Tokenizer.Token.html"><span class="hs-identifier">Tokenizer.Token</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier">Token</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="annot"><span class="hs-comment">-- | Parser type alias for a token stream using Megaparsec.</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">type</span><span> </span><span id="Parser"><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-var">Parser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parsec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="annot"><span class="hs-comment">-- | Parse a comma-separated list of expressions.</span></span><span>
</span><span id="line-23"></span><span class="annot"><a href="Parser.Parser.html#pCommaExp"><span class="hs-identifier hs-type">pCommaExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-24"></span><span id="pCommaExp"><span class="annot"><span class="annottext">pCommaExp :: Parser [Expr]
</span><a href="Parser.Parser.html#pCommaExp"><span class="hs-identifier hs-var hs-var">pCommaExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; Parser [Expr] -&gt; Parser [Expr]
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Parser [Expr] -&gt; Parser [Expr]) -&gt; Parser [Expr] -&gt; Parser [Expr]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-25"></span><span>  </span><span id="local-6989586621679077529"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679077529"><span class="hs-identifier hs-var">first</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span id="local-6989586621679077531"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679077531"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Expr -&gt; Parser [Expr]
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#CommaToken"><span class="hs-identifier hs-var">CommaToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Expr -&gt; Parser Expr
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><span class="annottext">[Expr] -&gt; Parser [Expr]
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679077529"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Expr] -&gt; [Expr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679077531"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="annot"><span class="hs-comment">-- | Parse a function or method call expression.</span></span><span>
</span><span id="line-30"></span><span class="annot"><a href="Parser.Parser.html#pCallExp"><span class="hs-identifier hs-type">pCallExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-31"></span><span id="pCallExp"><span class="annot"><span class="annottext">pCallExp :: Parser Expr
</span><a href="Parser.Parser.html#pCallExp"><span class="hs-identifier hs-var hs-var">pCallExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-32"></span><span>  </span><span id="local-6989586621679077536"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679077536"><span class="hs-identifier hs-var">func</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pSingleTerm"><span class="hs-identifier hs-var">pSingleTerm</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Token
forall a.
ParsecT Void [Token] Identity a -&gt; ParsecT Void [Token] Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">lookAhead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LParenToken"><span class="hs-identifier hs-var">LParenToken</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Only succeed if next token is LParenToken</span><span>
</span><span id="line-34"></span><span>  </span><span id="local-6989586621679077540"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679077540"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Token -&gt; Parser [Expr] -&gt; Parser [Expr]
forall (m :: * -&gt; *) open close a.
Applicative m =&gt;
m open -&gt; m close -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">between</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LParenToken"><span class="hs-identifier hs-var">LParenToken</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RParenToken"><span class="hs-identifier hs-var">RParenToken</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser [Expr]
</span><a href="Parser.Parser.html#pCommaExp"><span class="hs-identifier hs-var">pCommaExp</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Parser Expr
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; [Expr] -&gt; Expr
</span><a href="Parser.AST.html#Call"><span class="hs-identifier hs-var">Call</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679077536"><span class="hs-identifier hs-var">func</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679077540"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="annot"><span class="hs-comment">-- | Parse a variable reference (identifier) as an expression.</span></span><span>
</span><span id="line-38"></span><span class="annot"><a href="Parser.Parser.html#pVariable"><span class="hs-identifier hs-type">pVariable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-39"></span><span id="pVariable"><span class="annot"><span class="annottext">pVariable :: Parser Expr
</span><a href="Parser.Parser.html#pVariable"><span class="hs-identifier hs-var hs-var">pVariable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Expr
</span><a href="Parser.AST.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Expr)
-&gt; ParsecT Void [Token] Identity String -&gt; Parser Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Token [Token] -&gt; Bool)
-&gt; ParsecT Void [Token] Identity (Token [Token])
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Bool
Token [Token] -&gt; Bool
</span><a href="Parser.Parser.html#isIdentifierToken"><span class="hs-identifier hs-var">isIdentifierToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token
-&gt; (Token -&gt; ParsecT Void [Token] Identity String)
-&gt; ParsecT Void [Token] Identity String
forall a b.
ParsecT Void [Token] Identity a
-&gt; (a -&gt; ParsecT Void [Token] Identity b)
-&gt; ParsecT Void [Token] Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#IdentifierToken"><span class="hs-identifier hs-type">IdentifierToken</span></a></span><span> </span><span id="local-6989586621679077550"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077550"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void [Token] Identity String
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077550"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="annot"><span class="hs-comment">-- | Predicate to determine if a token is an identifier.</span></span><span>
</span><span id="line-42"></span><span class="annot"><a href="Parser.Parser.html#isIdentifierToken"><span class="hs-identifier hs-type">isIdentifierToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-43"></span><span id="isIdentifierToken"><span class="annot"><span class="annottext">isIdentifierToken :: Token -&gt; Bool
</span><a href="Parser.Parser.html#isIdentifierToken"><span class="hs-identifier hs-var hs-var">isIdentifierToken</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#IdentifierToken"><span class="hs-identifier hs-type">IdentifierToken</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-44"></span><span class="annot"><a href="Parser.Parser.html#isIdentifierToken"><span class="hs-identifier hs-var">isIdentifierToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="annot"><span class="hs-comment">-- | Parse an integer literal.</span></span><span>
</span><span id="line-47"></span><span class="annot"><a href="Parser.Parser.html#pInteger"><span class="hs-identifier hs-type">pInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-48"></span><span id="pInteger"><span class="annot"><span class="annottext">pInteger :: Parser Expr
</span><a href="Parser.Parser.html#pInteger"><span class="hs-identifier hs-var hs-var">pInteger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Expr
</span><a href="Parser.AST.html#Int"><span class="hs-identifier hs-var">Int</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Expr) -&gt; ParsecT Void [Token] Identity Int -&gt; Parser Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Token [Token] -&gt; Bool)
-&gt; ParsecT Void [Token] Identity (Token [Token])
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Bool
Token [Token] -&gt; Bool
</span><a href="Parser.Parser.html#isIntegerToken"><span class="hs-identifier hs-var">isIntegerToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token
-&gt; (Token -&gt; ParsecT Void [Token] Identity Int)
-&gt; ParsecT Void [Token] Identity Int
forall a b.
ParsecT Void [Token] Identity a
-&gt; (a -&gt; ParsecT Void [Token] Identity b)
-&gt; ParsecT Void [Token] Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#IntegerToken"><span class="hs-identifier hs-type">IntegerToken</span></a></span><span> </span><span id="local-6989586621679077555"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077555"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ParsecT Void [Token] Identity Int
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077555"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><span class="hs-comment">-- | Predicate to determine if a token is an integer.</span></span><span>
</span><span id="line-51"></span><span class="annot"><a href="Parser.Parser.html#isIntegerToken"><span class="hs-identifier hs-type">isIntegerToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-52"></span><span id="isIntegerToken"><span class="annot"><span class="annottext">isIntegerToken :: Token -&gt; Bool
</span><a href="Parser.Parser.html#isIntegerToken"><span class="hs-identifier hs-var hs-var">isIntegerToken</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#IntegerToken"><span class="hs-identifier hs-type">IntegerToken</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-53"></span><span class="annot"><a href="Parser.Parser.html#isIntegerToken"><span class="hs-identifier hs-var">isIntegerToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="annot"><span class="hs-comment">-- | Parse a struct instantiation expression.</span></span><span>
</span><span id="line-56"></span><span class="annot"><a href="Parser.Parser.html#pNewStruct"><span class="hs-identifier hs-type">pNewStruct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-57"></span><span id="pNewStruct"><span class="annot"><span class="annottext">pNewStruct :: Parser Expr
</span><a href="Parser.Parser.html#pNewStruct"><span class="hs-identifier hs-var hs-var">pNewStruct</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#NewToken"><span class="hs-identifier hs-var">NewToken</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span id="local-6989586621679077558"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679077558"><span class="hs-identifier hs-var">structer</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pStructname"><span class="hs-identifier hs-var">pStructname</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LBraceToken"><span class="hs-identifier hs-var">LBraceToken</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621679077561"><span class="annot"><span class="annottext">[StructActualParam]
</span><a href="#local-6989586621679077561"><span class="hs-identifier hs-var">structParams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [StructActualParam]
</span><a href="Parser.Parser.html#pStructActualParams"><span class="hs-identifier hs-var">pStructActualParams</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RBraceToken"><span class="hs-identifier hs-var">RBraceToken</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Parser Expr
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Parser Expr) -&gt; Expr -&gt; Parser Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [StructActualParam] -&gt; Expr
</span><a href="Parser.AST.html#NewStruct"><span class="hs-identifier hs-var">NewStruct</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679077558"><span class="hs-identifier hs-var">structer</span></a></span><span> </span><span class="annot"><span class="annottext">[StructActualParam]
</span><a href="#local-6989586621679077561"><span class="hs-identifier hs-var">structParams</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><span class="hs-comment">-- | Check that a token matches the expected token.</span></span><span>
</span><span id="line-66"></span><span class="annot"><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-type">checkMatchingToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-67"></span><span id="checkMatchingToken"><span class="annot"><span class="annottext">checkMatchingToken :: Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var hs-var">checkMatchingToken</span></a></span></span><span> </span><span id="local-6989586621679077566"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077566"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser Token -&gt; Parser Token
forall a.
String
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
String -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077566"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Parser Token -&gt; Parser Token) -&gt; Parser Token -&gt; Parser Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Token [Token] -&gt; Bool)
-&gt; ParsecT Void [Token] Identity (Token [Token])
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Token -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077566"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- Expression Parsers</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | Parse an atomic expression including parentheses, identifiers, integers,</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- booleans, or struct instantiation.</span><span>
</span><span id="line-74"></span><span class="annot"><a href="Parser.Parser.html#pAtom"><span class="hs-identifier hs-type">pAtom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-75"></span><span id="pAtom"><span class="annot"><span class="annottext">pAtom :: Parser Expr
</span><a href="Parser.Parser.html#pAtom"><span class="hs-identifier hs-var hs-var">pAtom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Parser Expr] -&gt; Parser Expr
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pParensAtom"><span class="hs-identifier hs-var">pParensAtom</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pVariable"><span class="hs-identifier hs-var">pVariable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pInteger"><span class="hs-identifier hs-var">pInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pBoolean"><span class="hs-identifier hs-var">pBoolean</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pNewStruct"><span class="hs-identifier hs-var">pNewStruct</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><span class="hs-comment">-- | Parse an expression enclosed in parentheses.</span></span><span>
</span><span id="line-78"></span><span class="annot"><a href="Parser.Parser.html#pParensAtom"><span class="hs-identifier hs-type">pParensAtom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-79"></span><span id="pParensAtom"><span class="annot"><span class="annottext">pParensAtom :: Parser Expr
</span><a href="Parser.Parser.html#pParensAtom"><span class="hs-identifier hs-var hs-var">pParensAtom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Token -&gt; Parser Expr -&gt; Parser Expr
forall (m :: * -&gt; *) open close a.
Applicative m =&gt;
m open -&gt; m close -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">between</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LParenToken"><span class="hs-identifier hs-var">LParenToken</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RParenToken"><span class="hs-identifier hs-var">RParenToken</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="annot"><span class="hs-comment">-- | Parse a return statement.</span></span><span>
</span><span id="line-82"></span><span class="annot"><a href="Parser.Parser.html#pReturnStmt"><span class="hs-identifier hs-type">pReturnStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-83"></span><span id="pReturnStmt"><span class="annot"><span class="annottext">pReturnStmt :: Parser Stmt
</span><a href="Parser.Parser.html#pReturnStmt"><span class="hs-identifier hs-var hs-var">pReturnStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Expr -&gt; Stmt
</span><a href="Parser.AST.html#ReturnStmt"><span class="hs-identifier hs-var">ReturnStmt</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Expr -&gt; Stmt)
-&gt; ParsecT Void [Token] Identity (Maybe Expr) -&gt; Parser Stmt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ReturnToken"><span class="hs-identifier hs-var">ReturnToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token
-&gt; ParsecT Void [Token] Identity (Maybe Expr)
-&gt; ParsecT Void [Token] Identity (Maybe Expr)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Expr -&gt; ParsecT Void [Token] Identity (Maybe Expr)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Maybe Expr)
-&gt; Parser Token -&gt; ParsecT Void [Token] Identity (Maybe Expr)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SemiColonToken"><span class="hs-identifier hs-var">SemiColonToken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="annot"><span class="hs-comment">-- | Parse a print statement.</span></span><span>
</span><span id="line-86"></span><span class="annot"><a href="Parser.Parser.html#pPrintLnStmt"><span class="hs-identifier hs-type">pPrintLnStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-87"></span><span id="pPrintLnStmt"><span class="annot"><span class="annottext">pPrintLnStmt :: Parser Stmt
</span><a href="Parser.Parser.html#pPrintLnStmt"><span class="hs-identifier hs-var hs-var">pPrintLnStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Stmt
</span><a href="Parser.AST.html#PrintLnStmt"><span class="hs-identifier hs-var">PrintLnStmt</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Stmt) -&gt; Parser Expr -&gt; Parser Stmt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#PrintLnToken"><span class="hs-identifier hs-var">PrintLnToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Expr -&gt; Parser Expr
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pParensAtom"><span class="hs-identifier hs-var">pParensAtom</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Stmt -&gt; Parser Token -&gt; Parser Stmt
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SemiColonToken"><span class="hs-identifier hs-var">SemiColonToken</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">--- Type Parsers</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | Parse a type literal. Tries the function type parser first; on failure,</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- falls back to parsing an atomic type.</span><span>
</span><span id="line-95"></span><span class="annot"><a href="Parser.Parser.html#pType"><span class="hs-identifier hs-type">pType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-96"></span><span id="pType"><span class="annot"><span class="annottext">pType :: Parser Type
</span><a href="Parser.Parser.html#pType"><span class="hs-identifier hs-var hs-var">pType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Type -&gt; Parser Type
forall a.
ParsecT Void [Token] Identity a -&gt; ParsecT Void [Token] Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pFunctionType"><span class="hs-identifier hs-var">pFunctionType</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Type -&gt; Parser Type -&gt; Parser Type
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pAtomType"><span class="hs-identifier hs-var">pAtomType</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><span class="hs-comment">-- | Parse an atomic type.</span></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Parser.Parser.html#pAtomType"><span class="hs-identifier hs-type">pAtomType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-100"></span><span id="pAtomType"><span class="annot"><span class="annottext">pAtomType :: Parser Type
</span><a href="Parser.Parser.html#pAtomType"><span class="hs-identifier hs-var hs-var">pAtomType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="annottext">[Parser Type] -&gt; Parser Type
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pIntType"><span class="hs-identifier hs-var">pIntType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>      </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pVoidType"><span class="hs-identifier hs-var">pVoidType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>      </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pBooleanType"><span class="hs-identifier hs-var">pBooleanType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>      </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pSelfType"><span class="hs-identifier hs-var">pSelfType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>      </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pStructname"><span class="hs-identifier hs-var">pStructname</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pParenType"><span class="hs-identifier hs-var">pParenType</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><span class="hs-comment">-- | Parse a higher-order (function) type.</span></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Parser.Parser.html#pFunctionType"><span class="hs-identifier hs-type">pFunctionType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-112"></span><span id="pFunctionType"><span class="annot"><span class="annottext">pFunctionType :: Parser Type
</span><a href="Parser.Parser.html#pFunctionType"><span class="hs-identifier hs-var hs-var">pFunctionType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621679077592"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679077592"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Token
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity [Type]
-&gt; ParsecT Void [Token] Identity [Type]
forall (m :: * -&gt; *) open close a.
Applicative m =&gt;
m open -&gt; m close -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">between</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LParenToken"><span class="hs-identifier hs-var">LParenToken</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RParenToken"><span class="hs-identifier hs-var">RParenToken</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity [Type]
</span><a href="Parser.Parser.html#pArgType"><span class="hs-identifier hs-var">pArgType</span></a></span><span> </span><span class="hs-comment">-- Argument types</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ArrowToken"><span class="hs-identifier hs-var">ArrowToken</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span id="local-6989586621679077595"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679077595"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pType"><span class="hs-identifier hs-var">pType</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><span class="annottext">Type -&gt; Parser Type
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Parser Type) -&gt; Type -&gt; Parser Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type -&gt; Type
</span><a href="Parser.AST.html#HigherOrderType"><span class="hs-identifier hs-var">HigherOrderType</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679077592"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679077595"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><span class="hs-comment">-- | Parse a comma-separated list of argument types.</span></span><span>
</span><span id="line-119"></span><span class="annot"><a href="Parser.Parser.html#pArgType"><span class="hs-identifier hs-type">pArgType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-120"></span><span id="pArgType"><span class="annot"><span class="annottext">pArgType :: ParsecT Void [Token] Identity [Type]
</span><a href="Parser.Parser.html#pArgType"><span class="hs-identifier hs-var hs-var">pArgType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type]
-&gt; ParsecT Void [Token] Identity [Type]
-&gt; ParsecT Void [Token] Identity [Type]
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(ParsecT Void [Token] Identity [Type]
 -&gt; ParsecT Void [Token] Identity [Type])
-&gt; ParsecT Void [Token] Identity [Type]
-&gt; ParsecT Void [Token] Identity [Type]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679077597"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679077597"><span class="hs-identifier hs-var">firstArg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pAtomType"><span class="hs-identifier hs-var">pAtomType</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679077598"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679077598"><span class="hs-identifier hs-var">restArgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Type -&gt; ParsecT Void [Token] Identity [Type]
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#CommaToken"><span class="hs-identifier hs-var">CommaToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Type -&gt; Parser Type
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pAtomType"><span class="hs-identifier hs-var">pAtomType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><span class="annottext">[Type] -&gt; ParsecT Void [Token] Identity [Type]
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679077597"><span class="hs-identifier hs-var">firstArg</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679077598"><span class="hs-identifier hs-var">restArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><span class="hs-comment">-- | Parse the integer type.</span></span><span>
</span><span id="line-126"></span><span class="annot"><a href="Parser.Parser.html#pIntType"><span class="hs-identifier hs-type">pIntType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-127"></span><span id="pIntType"><span class="annot"><span class="annottext">pIntType :: Parser Type
</span><a href="Parser.Parser.html#pIntType"><span class="hs-identifier hs-var hs-var">pIntType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="Parser.AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Parser Token -&gt; Parser Type
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#IntToken"><span class="hs-identifier hs-var">IntToken</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><span class="hs-comment">-- | Parse the void type.</span></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Parser.Parser.html#pVoidType"><span class="hs-identifier hs-type">pVoidType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-131"></span><span id="pVoidType"><span class="annot"><span class="annottext">pVoidType :: Parser Type
</span><a href="Parser.Parser.html#pVoidType"><span class="hs-identifier hs-var hs-var">pVoidType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="Parser.AST.html#VoidType"><span class="hs-identifier hs-var">VoidType</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Parser Token -&gt; Parser Type
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#VoidToken"><span class="hs-identifier hs-var">VoidToken</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><span class="hs-comment">-- | Parse the boolean type.</span></span><span>
</span><span id="line-134"></span><span class="annot"><a href="Parser.Parser.html#pBooleanType"><span class="hs-identifier hs-type">pBooleanType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-135"></span><span id="pBooleanType"><span class="annot"><span class="annottext">pBooleanType :: Parser Type
</span><a href="Parser.Parser.html#pBooleanType"><span class="hs-identifier hs-var hs-var">pBooleanType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="Parser.AST.html#BooleanType"><span class="hs-identifier hs-var">BooleanType</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Parser Token -&gt; Parser Type
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#BooleanToken"><span class="hs-identifier hs-var">BooleanToken</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><span class="hs-comment">-- | Parse the 'Self' type.</span></span><span>
</span><span id="line-138"></span><span class="annot"><a href="Parser.Parser.html#pSelfType"><span class="hs-identifier hs-type">pSelfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-139"></span><span id="pSelfType"><span class="annot"><span class="annottext">pSelfType :: Parser Type
</span><a href="Parser.Parser.html#pSelfType"><span class="hs-identifier hs-var hs-var">pSelfType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="Parser.AST.html#SelfType"><span class="hs-identifier hs-var">SelfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Parser Token -&gt; Parser Type
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SelfToken"><span class="hs-identifier hs-var">SelfToken</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><a href="Parser.Parser.html#pStructname"><span class="hs-identifier hs-type">pStructname</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-142"></span><span id="pStructname"><span class="annot"><span class="annottext">pStructname :: Parser Type
</span><a href="Parser.Parser.html#pStructname"><span class="hs-identifier hs-var hs-var">pStructname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Type
</span><a href="Parser.AST.html#StructName"><span class="hs-identifier hs-var">StructName</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Type)
-&gt; ParsecT Void [Token] Identity String -&gt; Parser Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Token [Token] -&gt; Bool)
-&gt; ParsecT Void [Token] Identity (Token [Token])
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Bool
Token [Token] -&gt; Bool
</span><a href="Parser.Parser.html#isIdentifierToken"><span class="hs-identifier hs-var">isIdentifierToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token
-&gt; (Token -&gt; ParsecT Void [Token] Identity String)
-&gt; ParsecT Void [Token] Identity String
forall a b.
ParsecT Void [Token] Identity a
-&gt; (a -&gt; ParsecT Void [Token] Identity b)
-&gt; ParsecT Void [Token] Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#IdentifierToken"><span class="hs-identifier hs-type">IdentifierToken</span></a></span><span> </span><span id="local-6989586621679077609"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077609"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void [Token] Identity String
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077609"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="annot"><span class="hs-comment">-- | Parse a parenthesized type.</span></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Parser.Parser.html#pParenType"><span class="hs-identifier hs-type">pParenType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-146"></span><span id="pParenType"><span class="annot"><span class="annottext">pParenType :: Parser Type
</span><a href="Parser.Parser.html#pParenType"><span class="hs-identifier hs-var hs-var">pParenType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Token -&gt; Parser Type -&gt; Parser Type
forall (m :: * -&gt; *) open close a.
Applicative m =&gt;
m open -&gt; m close -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">between</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LParenToken"><span class="hs-identifier hs-var">LParenToken</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RParenToken"><span class="hs-identifier hs-var">RParenToken</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pType"><span class="hs-identifier hs-var">pType</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- Parameter Parsers</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><span class="hs-comment">-- | Parse a parameter.</span></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Parser.Parser.html#pParam"><span class="hs-identifier hs-type">pParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span>
</span><span id="line-153"></span><span id="pParam"><span class="annot"><span class="annottext">pParam :: Parser Param
</span><a href="Parser.Parser.html#pParam"><span class="hs-identifier hs-var hs-var">pParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Param -&gt; Parser Param
forall a.
ParsecT Void [Token] Identity a -&gt; ParsecT Void [Token] Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">Parser Param
</span><a href="Parser.Parser.html#pAtomParam"><span class="hs-identifier hs-var">pAtomParam</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><span class="hs-comment">-- | Parse a comma-separated list of parameters.</span></span><span>
</span><span id="line-156"></span><span class="annot"><a href="Parser.Parser.html#pCommaParam"><span class="hs-identifier hs-type">pCommaParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Parser.AST.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-157"></span><span id="pCommaParam"><span class="annot"><span class="annottext">pCommaParam :: Parser [Param]
</span><a href="Parser.Parser.html#pCommaParam"><span class="hs-identifier hs-var hs-var">pCommaParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Param] -&gt; Parser [Param] -&gt; Parser [Param]
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Parser [Param] -&gt; Parser [Param])
-&gt; Parser [Param] -&gt; Parser [Param]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621679077613"><span class="annot"><span class="annottext">Param
</span><a href="#local-6989586621679077613"><span class="hs-identifier hs-var">firstParam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Param
</span><a href="Parser.Parser.html#pAtomParam"><span class="hs-identifier hs-var">pAtomParam</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621679077614"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621679077614"><span class="hs-identifier hs-var">restParams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Param -&gt; Parser [Param]
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#CommaToken"><span class="hs-identifier hs-var">CommaToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Param -&gt; Parser Param
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Param
</span><a href="Parser.Parser.html#pAtomParam"><span class="hs-identifier hs-var">pAtomParam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><span class="annottext">[Param] -&gt; Parser [Param]
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Param
</span><a href="#local-6989586621679077613"><span class="hs-identifier hs-var">firstParam</span></a></span><span> </span><span class="annot"><span class="annottext">Param -&gt; [Param] -&gt; [Param]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621679077614"><span class="hs-identifier hs-var">restParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><span class="hs-comment">-- | Parse a single parameter.</span></span><span>
</span><span id="line-163"></span><span class="annot"><a href="Parser.Parser.html#pAtomParam"><span class="hs-identifier hs-type">pAtomParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span>
</span><span id="line-164"></span><span id="pAtomParam"><span class="annot"><span class="annottext">pAtomParam :: Parser Param
</span><a href="Parser.Parser.html#pAtomParam"><span class="hs-identifier hs-var hs-var">pAtomParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Type -&gt; Param
</span><a href="Parser.AST.html#Param"><span class="hs-identifier hs-var">Param</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; Type -&gt; Param)
-&gt; ParsecT Void [Token] Identity String
-&gt; ParsecT Void [Token] Identity (Type -&gt; Param)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Token [Token] -&gt; Bool)
-&gt; ParsecT Void [Token] Identity (Token [Token])
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Bool
Token [Token] -&gt; Bool
</span><a href="Parser.Parser.html#isIdentifierToken"><span class="hs-identifier hs-var">isIdentifierToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token
-&gt; (Token -&gt; ParsecT Void [Token] Identity String)
-&gt; ParsecT Void [Token] Identity String
forall a b.
ParsecT Void [Token] Identity a
-&gt; (a -&gt; ParsecT Void [Token] Identity b)
-&gt; ParsecT Void [Token] Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#IdentifierToken"><span class="hs-identifier hs-type">IdentifierToken</span></a></span><span> </span><span id="local-6989586621679077616"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077616"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void [Token] Identity String
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077616"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Type -&gt; Param)
-&gt; Parser Token -&gt; ParsecT Void [Token] Identity (Type -&gt; Param)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ColonToken"><span class="hs-identifier hs-var">ColonToken</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Type -&gt; Param)
-&gt; Parser Type -&gt; Parser Param
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pType"><span class="hs-identifier hs-var">pType</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">--- Statement Parsers</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><span class="hs-comment">-- | Parse a let statement.</span></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Parser.Parser.html#pLetStmt"><span class="hs-identifier hs-type">pLetStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-174"></span><span id="pLetStmt"><span class="annot"><span class="annottext">pLetStmt :: Parser Stmt
</span><a href="Parser.Parser.html#pLetStmt"><span class="hs-identifier hs-var hs-var">pLetStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><span class="annottext">Param -&gt; Expr -&gt; Stmt
</span><a href="Parser.AST.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="annottext">(Param -&gt; Expr -&gt; Stmt)
-&gt; Parser Param -&gt; ParsecT Void [Token] Identity (Expr -&gt; Stmt)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LetToken"><span class="hs-identifier hs-var">LetToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Param -&gt; Parser Param
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Param
</span><a href="Parser.Parser.html#pParam"><span class="hs-identifier hs-var">pParam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Expr -&gt; Stmt)
-&gt; Parser Expr -&gt; Parser Stmt
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#EqualToken"><span class="hs-identifier hs-var">EqualToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Expr -&gt; Parser Expr
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Expr -&gt; Parser Token -&gt; Parser Expr
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SemiColonToken"><span class="hs-identifier hs-var">SemiColonToken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><span class="hs-comment">-- | Parse an assignment statement.</span></span><span>
</span><span id="line-180"></span><span class="annot"><a href="Parser.Parser.html#pAssgStmt"><span class="hs-identifier hs-type">pAssgStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-181"></span><span id="pAssgStmt"><span class="annot"><span class="annottext">pAssgStmt :: Parser Stmt
</span><a href="Parser.Parser.html#pAssgStmt"><span class="hs-identifier hs-var hs-var">pAssgStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Stmt
</span><a href="Parser.AST.html#AssgStmt"><span class="hs-identifier hs-var">AssgStmt</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">(Expr -&gt; Expr -&gt; Stmt)
-&gt; Parser Expr -&gt; ParsecT Void [Token] Identity (Expr -&gt; Stmt)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Expr -&gt; Parser Token -&gt; Parser Expr
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#EqualToken"><span class="hs-identifier hs-var">EqualToken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Expr -&gt; Stmt)
-&gt; Parser Expr -&gt; Parser Stmt
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Expr -&gt; Parser Token -&gt; Parser Expr
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SemiColonToken"><span class="hs-identifier hs-var">SemiColonToken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><span class="hs-comment">-- | Parse an assignment statement without a trailing semicolon.</span></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Parser.Parser.html#pAssgStmtSemiLess"><span class="hs-identifier hs-type">pAssgStmtSemiLess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-188"></span><span id="pAssgStmtSemiLess"><span class="annot"><span class="annottext">pAssgStmtSemiLess :: Parser Stmt
</span><a href="Parser.Parser.html#pAssgStmtSemiLess"><span class="hs-identifier hs-var hs-var">pAssgStmtSemiLess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Stmt
</span><a href="Parser.AST.html#AssgStmt"><span class="hs-identifier hs-var">AssgStmt</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr -&gt; Stmt)
-&gt; Parser Expr -&gt; ParsecT Void [Token] Identity (Expr -&gt; Stmt)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Expr -&gt; Parser Token -&gt; Parser Expr
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#EqualToken"><span class="hs-identifier hs-var">EqualToken</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Expr -&gt; Stmt)
-&gt; Parser Expr -&gt; Parser Stmt
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="annot"><span class="hs-comment">-- | Parse an expression used as a statement.</span></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Parser.Parser.html#pExprStmt"><span class="hs-identifier hs-type">pExprStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-192"></span><span id="pExprStmt"><span class="annot"><span class="annottext">pExprStmt :: Parser Stmt
</span><a href="Parser.Parser.html#pExprStmt"><span class="hs-identifier hs-var hs-var">pExprStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Stmt
</span><a href="Parser.AST.html#ExprStmt"><span class="hs-identifier hs-var">ExprStmt</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Stmt) -&gt; Parser Expr -&gt; Parser Stmt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Stmt -&gt; Parser Token -&gt; Parser Stmt
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SemiColonToken"><span class="hs-identifier hs-var">SemiColonToken</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="annot"><span class="hs-comment">-- | Parse a break statement.</span></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Parser.Parser.html#pBreakStmt"><span class="hs-identifier hs-type">pBreakStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-196"></span><span id="pBreakStmt"><span class="annot"><span class="annottext">pBreakStmt :: Parser Stmt
</span><a href="Parser.Parser.html#pBreakStmt"><span class="hs-identifier hs-var hs-var">pBreakStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="Parser.AST.html#BreakStmt"><span class="hs-identifier hs-var">BreakStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; Parser Token -&gt; Parser Stmt
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#BreakToken"><span class="hs-identifier hs-var">BreakToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Token -&gt; Parser Token
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SemiColonToken"><span class="hs-identifier hs-var">SemiColonToken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="annot"><span class="hs-comment">-- | Parse a block of statements.</span></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Parser.Parser.html#pBlockStmt"><span class="hs-identifier hs-type">pBlockStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-200"></span><span id="pBlockStmt"><span class="annot"><span class="annottext">pBlockStmt :: Parser Stmt
</span><a href="Parser.Parser.html#pBlockStmt"><span class="hs-identifier hs-var hs-var">pBlockStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; Stmt
</span><a href="Parser.AST.html#BlockStmt"><span class="hs-identifier hs-var">BlockStmt</span></a></span><span> </span><span class="annot"><span class="annottext">([Stmt] -&gt; Stmt)
-&gt; ParsecT Void [Token] Identity [Stmt] -&gt; Parser Stmt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LBraceToken"><span class="hs-identifier hs-var">LBraceToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token
-&gt; ParsecT Void [Token] Identity [Stmt]
-&gt; ParsecT Void [Token] Identity [Stmt]
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt -&gt; ParsecT Void [Token] Identity [Stmt]
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pStmt"><span class="hs-identifier hs-var">pStmt</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity [Stmt]
-&gt; Parser Token -&gt; ParsecT Void [Token] Identity [Stmt]
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RBraceToken"><span class="hs-identifier hs-var">RBraceToken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="annot"><span class="hs-comment">-- | Parse a while statement.</span></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Parser.Parser.html#pWhileStmt"><span class="hs-identifier hs-type">pWhileStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-204"></span><span id="pWhileStmt"><span class="annot"><span class="annottext">pWhileStmt :: Parser Stmt
</span><a href="Parser.Parser.html#pWhileStmt"><span class="hs-identifier hs-var hs-var">pWhileStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Stmt -&gt; Stmt
</span><a href="Parser.AST.html#WhileStmt"><span class="hs-identifier hs-var">WhileStmt</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">(Expr -&gt; Stmt -&gt; Stmt)
-&gt; Parser Expr -&gt; ParsecT Void [Token] Identity (Stmt -&gt; Stmt)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#WhileToken"><span class="hs-identifier hs-var">WhileToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Expr -&gt; Parser Expr
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pCondition"><span class="hs-identifier hs-var">pCondition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Stmt -&gt; Stmt)
-&gt; Parser Stmt -&gt; Parser Stmt
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pBlockStmt"><span class="hs-identifier hs-var">pBlockStmt</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><span class="hs-comment">-- | Parse a for loop statement.</span></span><span>
</span><span id="line-210"></span><span class="annot"><a href="Parser.Parser.html#pForStmt"><span class="hs-identifier hs-type">pForStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-211"></span><span id="pForStmt"><span class="annot"><span class="annottext">pForStmt :: Parser Stmt
</span><a href="Parser.Parser.html#pForStmt"><span class="hs-identifier hs-var hs-var">pForStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ForToken"><span class="hs-identifier hs-var">ForToken</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LParenToken"><span class="hs-identifier hs-var">LParenToken</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span id="local-6989586621679077639"><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679077639"><span class="hs-identifier hs-var">initStmt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pLetStmt"><span class="hs-identifier hs-var">pLetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Stmt -&gt; Parser Stmt -&gt; Parser Stmt
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pAssgStmt"><span class="hs-identifier hs-var">pAssgStmt</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span id="local-6989586621679077640"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679077640"><span class="hs-identifier hs-var">condExpr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Expr -&gt; Parser Token -&gt; Parser Expr
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SemiColonToken"><span class="hs-identifier hs-var">SemiColonToken</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621679077641"><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679077641"><span class="hs-identifier hs-var">postStmt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pAssgStmtSemiLess"><span class="hs-identifier hs-var">pAssgStmtSemiLess</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RParenToken"><span class="hs-identifier hs-var">RParenToken</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679077642"><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679077642"><span class="hs-identifier hs-var">bodyStmt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pStmt"><span class="hs-identifier hs-var">pStmt</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="annottext">Stmt -&gt; Parser Stmt
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Stmt -&gt; Parser Stmt) -&gt; Stmt -&gt; Parser Stmt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; Expr -&gt; Stmt -&gt; Stmt -&gt; Stmt
</span><a href="Parser.AST.html#ForStmt"><span class="hs-identifier hs-var">ForStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679077639"><span class="hs-identifier hs-var">initStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679077640"><span class="hs-identifier hs-var">condExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679077641"><span class="hs-identifier hs-var">postStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Stmt
</span><a href="#local-6989586621679077642"><span class="hs-identifier hs-var">bodyStmt</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><span class="hs-comment">-- | Parse any statement.</span></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Parser.Parser.html#pStmt"><span class="hs-identifier hs-type">pStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-223"></span><span id="pStmt"><span class="annot"><span class="annottext">pStmt :: Parser Stmt
</span><a href="Parser.Parser.html#pStmt"><span class="hs-identifier hs-var hs-var">pStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="annottext">[Parser Stmt] -&gt; Parser Stmt
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pLetStmt"><span class="hs-identifier hs-var">pLetStmt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-226"></span><span>      </span><span class="annot"><span class="annottext">Parser Stmt -&gt; Parser Stmt
forall a.
ParsecT Void [Token] Identity a -&gt; ParsecT Void [Token] Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pAssgStmt"><span class="hs-identifier hs-var">pAssgStmt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-227"></span><span>      </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pIfStmt"><span class="hs-identifier hs-var">pIfStmt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pWhileStmt"><span class="hs-identifier hs-var">pWhileStmt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pForStmt"><span class="hs-identifier hs-var">pForStmt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-230"></span><span>      </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pBreakStmt"><span class="hs-identifier hs-var">pBreakStmt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-231"></span><span>      </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pPrintLnStmt"><span class="hs-identifier hs-var">pPrintLnStmt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-232"></span><span>      </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pBlockStmt"><span class="hs-identifier hs-var">pBlockStmt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pReturnStmt"><span class="hs-identifier hs-var">pReturnStmt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pExprStmt"><span class="hs-identifier hs-var">pExprStmt</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="annot"><span class="hs-comment">-- | Parse a boolean literal.</span></span><span>
</span><span id="line-238"></span><span class="annot"><a href="Parser.Parser.html#pBoolean"><span class="hs-identifier hs-type">pBoolean</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-239"></span><span id="pBoolean"><span class="annot"><span class="annottext">pBoolean :: Parser Expr
</span><a href="Parser.Parser.html#pBoolean"><span class="hs-identifier hs-var hs-var">pBoolean</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Expr
</span><a href="Parser.AST.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;true&quot;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Parser Token -&gt; Parser Expr
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#TrueToken"><span class="hs-identifier hs-var">TrueToken</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Expr -&gt; Parser Expr -&gt; Parser Expr
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Expr
</span><a href="Parser.AST.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;false&quot;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Parser Token -&gt; Parser Expr
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#FalseToken"><span class="hs-identifier hs-var">FalseToken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="annot"><span class="hs-comment">-- | Parse the 'self' expression.</span></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Parser.Parser.html#pSelf"><span class="hs-identifier hs-type">pSelf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-243"></span><span id="pSelf"><span class="annot"><span class="annottext">pSelf :: Parser Expr
</span><a href="Parser.Parser.html#pSelf"><span class="hs-identifier hs-var hs-var">pSelf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="Parser.AST.html#LowerSelf"><span class="hs-identifier hs-var">LowerSelf</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Parser Token -&gt; Parser Expr
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LowerCaseSelfToken"><span class="hs-identifier hs-var">LowerCaseSelfToken</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><a href="Parser.Parser.html#pTrue"><span class="hs-identifier hs-type">pTrue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-246"></span><span id="pTrue"><span class="annot"><span class="annottext">pTrue :: Parser Expr
</span><a href="Parser.Parser.html#pTrue"><span class="hs-identifier hs-var hs-var">pTrue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="Parser.AST.html#Trueish"><span class="hs-identifier hs-var">Trueish</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Parser Token -&gt; Parser Expr
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#TrueToken"><span class="hs-identifier hs-var">TrueToken</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><a href="Parser.Parser.html#pFalse"><span class="hs-identifier hs-type">pFalse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-249"></span><span id="pFalse"><span class="annot"><span class="annottext">pFalse :: Parser Expr
</span><a href="Parser.Parser.html#pFalse"><span class="hs-identifier hs-var hs-var">pFalse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="Parser.AST.html#Falseish"><span class="hs-identifier hs-var">Falseish</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Parser Token -&gt; Parser Expr
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#FalseToken"><span class="hs-identifier hs-var">FalseToken</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- Parse parentheses</span><span>
</span><span id="line-252"></span><span class="annot"><a href="Parser.Parser.html#pParens"><span class="hs-identifier hs-type">pParens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-253"></span><span id="pParens"><span class="annot"><span class="annottext">pParens :: Parser Expr
</span><a href="Parser.Parser.html#pParens"><span class="hs-identifier hs-var hs-var">pParens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Token -&gt; Parser Expr -&gt; Parser Expr
forall (m :: * -&gt; *) open close a.
Applicative m =&gt;
m open -&gt; m close -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">between</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LParenToken"><span class="hs-identifier hs-var">LParenToken</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RParenToken"><span class="hs-identifier hs-var">RParenToken</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="annot"><span class="hs-comment">-- | Parse an if statement.</span></span><span>
</span><span id="line-256"></span><span class="annot"><a href="Parser.Parser.html#pIfStmt"><span class="hs-identifier hs-type">pIfStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-257"></span><span id="pIfStmt"><span class="annot"><span class="annottext">pIfStmt :: Parser Stmt
</span><a href="Parser.Parser.html#pIfStmt"><span class="hs-identifier hs-var hs-var">pIfStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Stmt -&gt; Maybe Stmt -&gt; Stmt
</span><a href="Parser.AST.html#IfStmt"><span class="hs-identifier hs-var">IfStmt</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">(Expr -&gt; Stmt -&gt; Maybe Stmt -&gt; Stmt)
-&gt; Parser Expr
-&gt; ParsecT Void [Token] Identity (Stmt -&gt; Maybe Stmt -&gt; Stmt)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#IfToken"><span class="hs-identifier hs-var">IfToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Expr -&gt; Parser Expr
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pCondition"><span class="hs-identifier hs-var">pCondition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Stmt -&gt; Maybe Stmt -&gt; Stmt)
-&gt; Parser Stmt
-&gt; ParsecT Void [Token] Identity (Maybe Stmt -&gt; Stmt)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pStmt"><span class="hs-identifier hs-var">pStmt</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Maybe Stmt -&gt; Stmt)
-&gt; ParsecT Void [Token] Identity (Maybe Stmt) -&gt; Parser Stmt
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt -&gt; ParsecT Void [Token] Identity (Maybe Stmt)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pElseOrElseIf"><span class="hs-identifier hs-var">pElseOrElseIf</span></a></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="annot"><span class="hs-comment">-- | Parse an else or else-if block.</span></span><span>
</span><span id="line-264"></span><span class="annot"><a href="Parser.Parser.html#pElseOrElseIf"><span class="hs-identifier hs-type">pElseOrElseIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-265"></span><span id="pElseOrElseIf"><span class="annot"><span class="annottext">pElseOrElseIf :: Parser Stmt
</span><a href="Parser.Parser.html#pElseOrElseIf"><span class="hs-identifier hs-var hs-var">pElseOrElseIf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ElseToken"><span class="hs-identifier hs-var">ElseToken</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span class="annot"><span class="annottext">[Parser Stmt] -&gt; Parser Stmt
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Stmt -&gt; Maybe Stmt -&gt; Stmt
</span><a href="Parser.AST.html#IfStmt"><span class="hs-identifier hs-var">IfStmt</span></a></span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="annottext">(Expr -&gt; Stmt -&gt; Maybe Stmt -&gt; Stmt)
-&gt; Parser Expr
-&gt; ParsecT Void [Token] Identity (Stmt -&gt; Maybe Stmt -&gt; Stmt)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#IfToken"><span class="hs-identifier hs-var">IfToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Expr -&gt; Parser Expr
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pCondition"><span class="hs-identifier hs-var">pCondition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Stmt -&gt; Maybe Stmt -&gt; Stmt)
-&gt; Parser Stmt
-&gt; ParsecT Void [Token] Identity (Maybe Stmt -&gt; Stmt)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LBraceToken"><span class="hs-identifier hs-var">LBraceToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Stmt -&gt; Parser Stmt
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pStmt"><span class="hs-identifier hs-var">pStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Stmt -&gt; Parser Token -&gt; Parser Stmt
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RBraceToken"><span class="hs-identifier hs-var">RBraceToken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Maybe Stmt -&gt; Stmt)
-&gt; ParsecT Void [Token] Identity (Maybe Stmt) -&gt; Parser Stmt
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt -&gt; ParsecT Void [Token] Identity (Maybe Stmt)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pElseOrElseIf"><span class="hs-identifier hs-var">pElseOrElseIf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-272"></span><span>      </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pStmt"><span class="hs-identifier hs-var">pStmt</span></a></span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><span class="hs-comment">-- | Parse a condition expression.</span></span><span>
</span><span id="line-276"></span><span class="annot"><a href="Parser.Parser.html#pCondition"><span class="hs-identifier hs-type">pCondition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-277"></span><span id="pCondition"><span class="annot"><span class="annottext">pCondition :: Parser Expr
</span><a href="Parser.Parser.html#pCondition"><span class="hs-identifier hs-var hs-var">pCondition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Expr
-&gt; [[Operator (ParsecT Void [Token] Identity) Expr]] -&gt; Parser Expr
forall (m :: * -&gt; *) a.
MonadPlus m =&gt;
m a -&gt; [[Operator m a]] -&gt; m a
</span><span class="hs-identifier hs-var">makeExprParser</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#condTerm"><span class="hs-identifier hs-var">condTerm</span></a></span><span> </span><span class="annot"><span class="annottext">[[Operator (ParsecT Void [Token] Identity) Expr]]
</span><a href="Parser.Parser.html#condOperatorTable"><span class="hs-identifier hs-var">condOperatorTable</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="annot"><span class="hs-comment">-- | Parse an expression followed by a semicolon (used in conditions).</span></span><span>
</span><span id="line-280"></span><span class="annot"><a href="Parser.Parser.html#pPainandMisery"><span class="hs-identifier hs-type">pPainandMisery</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-281"></span><span id="pPainandMisery"><span class="annot"><span class="annottext">pPainandMisery :: Parser Expr
</span><a href="Parser.Parser.html#pPainandMisery"><span class="hs-identifier hs-var hs-var">pPainandMisery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Expr -&gt; Parser Token -&gt; Parser Expr
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SemiColonToken"><span class="hs-identifier hs-var">SemiColonToken</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="annot"><span class="hs-comment">-- | Parse a condition enclosed in parentheses.</span></span><span>
</span><span id="line-284"></span><span class="annot"><a href="Parser.Parser.html#pParensCondition"><span class="hs-identifier hs-type">pParensCondition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-285"></span><span id="pParensCondition"><span class="annot"><span class="annottext">pParensCondition :: Parser Expr
</span><a href="Parser.Parser.html#pParensCondition"><span class="hs-identifier hs-var hs-var">pParensCondition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Token -&gt; Parser Expr -&gt; Parser Expr
forall (m :: * -&gt; *) open close a.
Applicative m =&gt;
m open -&gt; m close -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">between</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LParenToken"><span class="hs-identifier hs-var">LParenToken</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RParenToken"><span class="hs-identifier hs-var">RParenToken</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pCondition"><span class="hs-identifier hs-var">pCondition</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="annot"><span class="hs-comment">-- | Parses a conditional term expression in the following order from top to bottom:</span></span><span>
</span><span id="line-288"></span><span class="annot"><a href="Parser.Parser.html#condTerm"><span class="hs-identifier hs-type">condTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-289"></span><span id="condTerm"><span class="annot"><span class="annottext">condTerm :: Parser Expr
</span><a href="Parser.Parser.html#condTerm"><span class="hs-identifier hs-var hs-var">condTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><span class="annottext">[Parser Expr] -&gt; Parser Expr
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pBoolean"><span class="hs-identifier hs-var">pBoolean</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pVariable"><span class="hs-identifier hs-var">pVariable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pInteger"><span class="hs-identifier hs-var">pInteger</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pParensCondition"><span class="hs-identifier hs-var">pParensCondition</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-295"></span><span>      </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pSelf"><span class="hs-identifier hs-var">pSelf</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><span class="hs-comment">-- | Operator table for condition expressions.</span></span><span>
</span><span id="line-299"></span><span class="annot"><a href="Parser.Parser.html#condOperatorTable"><span class="hs-identifier hs-type">condOperatorTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Operator</span></span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-300"></span><span id="condOperatorTable"><span class="annot"><span class="annottext">condOperatorTable :: [[Operator (ParsecT Void [Token] Identity) Expr]]
</span><a href="Parser.Parser.html#condOperatorTable"><span class="hs-identifier hs-var hs-var">condOperatorTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var">binary</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#EqualsToken"><span class="hs-identifier hs-var">EqualsToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Parser.AST.html#Equals"><span class="hs-identifier hs-var">Equals</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-302"></span><span>      </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var">binary</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#NotEqualToken"><span class="hs-identifier hs-var">NotEqualToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Parser.AST.html#NotEquals"><span class="hs-identifier hs-var">NotEquals</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-303"></span><span>      </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var">binary</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#GreaterThanToken"><span class="hs-identifier hs-var">GreaterThanToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Parser.AST.html#GreaterThan"><span class="hs-identifier hs-var">GreaterThan</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-304"></span><span>      </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var">binary</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LessThanToken"><span class="hs-identifier hs-var">LessThanToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Parser.AST.html#LessThan"><span class="hs-identifier hs-var">LessThan</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="annot"><span class="hs-comment">-- | Parse a term expression (either a call expression or a single term).</span></span><span>
</span><span id="line-309"></span><span class="annot"><a href="Parser.Parser.html#pTerm"><span class="hs-identifier hs-type">pTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-310"></span><span id="pTerm"><span class="annot"><span class="annottext">pTerm :: Parser Expr
</span><a href="Parser.Parser.html#pTerm"><span class="hs-identifier hs-var hs-var">pTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Expr -&gt; Parser Expr
forall a.
ParsecT Void [Token] Identity a -&gt; ParsecT Void [Token] Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pCallExp"><span class="hs-identifier hs-var">pCallExp</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Expr -&gt; Parser Expr -&gt; Parser Expr
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pSingleTerm"><span class="hs-identifier hs-var">pSingleTerm</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="annot"><span class="hs-comment">-- | Parse a single term expression.</span></span><span>
</span><span id="line-313"></span><span class="annot"><a href="Parser.Parser.html#pSingleTerm"><span class="hs-identifier hs-type">pSingleTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-314"></span><span id="pSingleTerm"><span class="annot"><span class="annottext">pSingleTerm :: Parser Expr
</span><a href="Parser.Parser.html#pSingleTerm"><span class="hs-identifier hs-var hs-var">pSingleTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-315"></span><span>  </span><span class="annot"><span class="annottext">[Parser Expr] -&gt; Parser Expr
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pParens"><span class="hs-identifier hs-var">pParens</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pInteger"><span class="hs-identifier hs-var">pInteger</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pSelf"><span class="hs-identifier hs-var">pSelf</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pVariable"><span class="hs-identifier hs-var">pVariable</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pTrue"><span class="hs-identifier hs-var">pTrue</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pFalse"><span class="hs-identifier hs-var">pFalse</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pNewStruct"><span class="hs-identifier hs-var">pNewStruct</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="annot"><span class="hs-comment">-- | Parse an expression.</span></span><span>
</span><span id="line-327"></span><span class="annot"><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-type">pExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-328"></span><span id="pExpr"><span class="annot"><span class="annottext">pExpr :: Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var hs-var">pExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Expr
-&gt; [[Operator (ParsecT Void [Token] Identity) Expr]] -&gt; Parser Expr
forall (m :: * -&gt; *) a.
MonadPlus m =&gt;
m a -&gt; [[Operator m a]] -&gt; m a
</span><span class="hs-identifier hs-var">makeExprParser</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pTerm"><span class="hs-identifier hs-var">pTerm</span></a></span><span> </span><span class="annot"><span class="annottext">[[Operator (ParsecT Void [Token] Identity) Expr]]
</span><a href="Parser.Parser.html#operatorTable"><span class="hs-identifier hs-var">operatorTable</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="annot"><a href="Parser.Parser.html#operatorTable"><span class="hs-identifier hs-type">operatorTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Operator</span></span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-331"></span><span id="operatorTable"><span class="annot"><span class="annottext">operatorTable :: [[Operator (ParsecT Void [Token] Identity) Expr]]
</span><a href="Parser.Parser.html#operatorTable"><span class="hs-identifier hs-var hs-var">operatorTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr) -&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#prefix"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SubtractToken"><span class="hs-identifier hs-var">SubtractToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="Parser.AST.html#Negative"><span class="hs-identifier hs-var">Negative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-333"></span><span>      </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var">binary</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#DotToken"><span class="hs-identifier hs-var">DotToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Parser.AST.html#DotExpr"><span class="hs-identifier hs-var">DotExpr</span></a></span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var">binary</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#MultiplyToken"><span class="hs-identifier hs-var">MultiplyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Parser.AST.html#Multiply"><span class="hs-identifier hs-var">Multiply</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-336"></span><span>      </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var">binary</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#DivideToken"><span class="hs-identifier hs-var">DivideToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Parser.AST.html#Division"><span class="hs-identifier hs-var">Division</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var">binary</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#AddToken"><span class="hs-identifier hs-var">AddToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Parser.AST.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-339"></span><span>      </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var">binary</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SubtractToken"><span class="hs-identifier hs-var">SubtractToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Parser.AST.html#Sub"><span class="hs-identifier hs-var">Sub</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var">binary</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#EqualsToken"><span class="hs-identifier hs-var">EqualsToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Parser.AST.html#Equals"><span class="hs-identifier hs-var">Equals</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-342"></span><span>      </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var">binary</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#NotEqualToken"><span class="hs-identifier hs-var">NotEqualToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Parser.AST.html#NotEquals"><span class="hs-identifier hs-var">NotEquals</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-343"></span><span>      </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var">binary</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#GreaterThanToken"><span class="hs-identifier hs-var">GreaterThanToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Parser.AST.html#GreaterThan"><span class="hs-identifier hs-var">GreaterThan</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-344"></span><span>      </span><span class="annot"><span class="annottext">Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var">binary</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LessThanToken"><span class="hs-identifier hs-var">LessThanToken</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Parser.AST.html#LessThan"><span class="hs-identifier hs-var">LessThan</span></a></span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="annot"><span class="hs-comment">-- | Helper for binary operators.</span></span><span>
</span><span id="line-349"></span><span class="annot"><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-type">binary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Operator</span></span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-350"></span><span id="binary"><span class="annot"><span class="annottext">binary :: Token
-&gt; (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#binary"><span class="hs-identifier hs-var hs-var">binary</span></a></span></span><span> </span><span id="local-6989586621679077687"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077687"><span class="hs-identifier hs-var">tok</span></a></span></span><span> </span><span id="local-6989586621679077688"><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="#local-6989586621679077688"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser (Expr -&gt; Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
forall (m :: * -&gt; *) a. m (a -&gt; a -&gt; a) -&gt; Operator m a
</span><span class="hs-identifier hs-var">InfixL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="#local-6989586621679077688"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr -&gt; Expr)
-&gt; Parser Token -&gt; Parser (Expr -&gt; Expr -&gt; Expr)
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077687"><span class="hs-identifier hs-var">tok</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="annot"><span class="hs-comment">-- | Helper for prefix operators.</span></span><span>
</span><span id="line-353"></span><span class="annot"><a href="Parser.Parser.html#prefix"><span class="hs-identifier hs-type">prefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Operator</span></span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-354"></span><span id="prefix"><span class="annot"><span class="annottext">prefix :: Token
-&gt; (Expr -&gt; Expr) -&gt; Operator (ParsecT Void [Token] Identity) Expr
</span><a href="Parser.Parser.html#prefix"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span id="local-6989586621679077690"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077690"><span class="hs-identifier hs-var">tok</span></a></span></span><span> </span><span id="local-6989586621679077691"><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="#local-6989586621679077691"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser (Expr -&gt; Expr)
-&gt; Operator (ParsecT Void [Token] Identity) Expr
forall (m :: * -&gt; *) a. m (a -&gt; a) -&gt; Operator m a
</span><span class="hs-identifier hs-var">Prefix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="#local-6989586621679077691"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; Parser Token -&gt; Parser (Expr -&gt; Expr)
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077690"><span class="hs-identifier hs-var">tok</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="annot"><span class="hs-comment">-- | Parse a specific token.</span></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-type">symbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-358"></span><span id="symbol"><span class="annot"><span class="annottext">symbol :: Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var hs-var">symbol</span></a></span></span><span> </span><span id="local-6989586621679077693"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077693"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Token [Token] -&gt; Bool)
-&gt; ParsecT Void [Token] Identity (Token [Token])
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Token -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077693"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- Exported Parsing Functions</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="annot"><span class="hs-comment">-- | Parse an expression from a list of tokens.</span></span><span>
</span><span id="line-364"></span><span class="annot"><a href="Parser.Parser.html#parseExpression"><span class="hs-identifier hs-type">parseExpression</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Parser.AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-365"></span><span id="parseExpression"><span class="annot"><span class="annottext">parseExpression :: [Token] -&gt; Either (ParseErrorBundle [Token] Void) Expr
</span><a href="Parser.Parser.html#parseExpression"><span class="hs-identifier hs-var hs-var">parseExpression</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Expr
-&gt; String -&gt; [Token] -&gt; Either (ParseErrorBundle [Token] Void) Expr
forall e s a.
Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="annot"><span class="hs-comment">-- | Parse a type from a list of tokens.</span></span><span>
</span><span id="line-368"></span><span class="annot"><a href="Parser.Parser.html#parseType"><span class="hs-identifier hs-type">parseType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Parser.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-369"></span><span id="parseType"><span class="annot"><span class="annottext">parseType :: [Token] -&gt; Either (ParseErrorBundle [Token] Void) Type
</span><a href="Parser.Parser.html#parseType"><span class="hs-identifier hs-var hs-var">parseType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Type
-&gt; String -&gt; [Token] -&gt; Either (ParseErrorBundle [Token] Void) Type
forall e s a.
Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pType"><span class="hs-identifier hs-var">pType</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="annot"><span class="hs-comment">-- | Parse a parameter from a list of tokens.</span></span><span>
</span><span id="line-372"></span><span class="annot"><a href="Parser.Parser.html#parseParam"><span class="hs-identifier hs-type">parseParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Parser.AST.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span>
</span><span id="line-373"></span><span id="parseParam"><span class="annot"><span class="annottext">parseParam :: [Token] -&gt; Either (ParseErrorBundle [Token] Void) Param
</span><a href="Parser.Parser.html#parseParam"><span class="hs-identifier hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Param
-&gt; String
-&gt; [Token]
-&gt; Either (ParseErrorBundle [Token] Void) Param
forall e s a.
Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parser Param
</span><a href="Parser.Parser.html#pParam"><span class="hs-identifier hs-var">pParam</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="annot"><span class="hs-comment">-- | Parse a statement from a list of tokens.</span></span><span>
</span><span id="line-376"></span><span class="annot"><a href="Parser.Parser.html#parseStmt"><span class="hs-identifier hs-type">parseStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Parser.AST.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a></span><span>
</span><span id="line-377"></span><span id="parseStmt"><span class="annot"><span class="annottext">parseStmt :: [Token] -&gt; Either (ParseErrorBundle [Token] Void) Stmt
</span><a href="Parser.Parser.html#parseStmt"><span class="hs-identifier hs-var hs-var">parseStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Stmt
-&gt; String -&gt; [Token] -&gt; Either (ParseErrorBundle [Token] Void) Stmt
forall e s a.
Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pStmt"><span class="hs-identifier hs-var">pStmt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="annot"><span class="hs-comment">-- | Parse a TraitDef from a list of tokens.</span></span><span>
</span><span id="line-380"></span><span class="annot"><a href="Parser.Parser.html#pTraitDef"><span class="hs-identifier hs-type">pTraitDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Parser.AST.html#TraitDef"><span class="hs-identifier hs-type">TraitDef</span></a></span><span>
</span><span id="line-381"></span><span id="pTraitDef"><span class="annot"><span class="annottext">pTraitDef :: [Token] -&gt; Either (ParseErrorBundle [Token] Void) TraitDef
</span><a href="Parser.Parser.html#pTraitDef"><span class="hs-identifier hs-var hs-var">pTraitDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] TraitDef
-&gt; String
-&gt; [Token]
-&gt; Either (ParseErrorBundle [Token] Void) TraitDef
forall e s a.
Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] TraitDef
</span><a href="Parser.Parser.html#parseTraitDef"><span class="hs-identifier hs-var">parseTraitDef</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="annot"><span class="hs-comment">-- | Parse an AbsMethodDef from a list of tokens.</span></span><span>
</span><span id="line-384"></span><span class="annot"><a href="Parser.Parser.html#pAbsMethodDef"><span class="hs-identifier hs-type">pAbsMethodDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Parser.AST.html#AbsMethodDef"><span class="hs-identifier hs-type">AbsMethodDef</span></a></span><span>
</span><span id="line-385"></span><span id="pAbsMethodDef"><span class="annot"><span class="annottext">pAbsMethodDef :: [Token] -&gt; Either (ParseErrorBundle [Token] Void) AbsMethodDef
</span><a href="Parser.Parser.html#pAbsMethodDef"><span class="hs-identifier hs-var hs-var">pAbsMethodDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] AbsMethodDef
-&gt; String
-&gt; [Token]
-&gt; Either (ParseErrorBundle [Token] Void) AbsMethodDef
forall e s a.
Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] AbsMethodDef
</span><a href="Parser.Parser.html#parseAbsMethodDef"><span class="hs-identifier hs-var">parseAbsMethodDef</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="annot"><span class="hs-comment">-- | Parse a StructDef from a list of tokens.</span></span><span>
</span><span id="line-388"></span><span class="annot"><a href="Parser.Parser.html#pStructDef"><span class="hs-identifier hs-type">pStructDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Parser.AST.html#StructDef"><span class="hs-identifier hs-type">StructDef</span></a></span><span>
</span><span id="line-389"></span><span id="pStructDef"><span class="annot"><span class="annottext">pStructDef :: [Token] -&gt; Either (ParseErrorBundle [Token] Void) StructDef
</span><a href="Parser.Parser.html#pStructDef"><span class="hs-identifier hs-var hs-var">pStructDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] StructDef
-&gt; String
-&gt; [Token]
-&gt; Either (ParseErrorBundle [Token] Void) StructDef
forall e s a.
Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] StructDef
</span><a href="Parser.Parser.html#parseStructDef"><span class="hs-identifier hs-var">parseStructDef</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="annot"><span class="hs-comment">-- | Parse an ImplDef from a list of tokens.</span></span><span>
</span><span id="line-392"></span><span class="annot"><a href="Parser.Parser.html#pImplDef"><span class="hs-identifier hs-type">pImplDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Parser.AST.html#ImplDef"><span class="hs-identifier hs-type">ImplDef</span></a></span><span>
</span><span id="line-393"></span><span id="pImplDef"><span class="annot"><span class="annottext">pImplDef :: [Token] -&gt; Either (ParseErrorBundle [Token] Void) ImplDef
</span><a href="Parser.Parser.html#pImplDef"><span class="hs-identifier hs-var hs-var">pImplDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] ImplDef
-&gt; String
-&gt; [Token]
-&gt; Either (ParseErrorBundle [Token] Void) ImplDef
forall e s a.
Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] ImplDef
</span><a href="Parser.Parser.html#parseImplDef"><span class="hs-identifier hs-var">parseImplDef</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="annot"><span class="hs-comment">-- | Parse a ConcMethodDef from a list of tokens.</span></span><span>
</span><span id="line-396"></span><span class="annot"><a href="Parser.Parser.html#pConcMethodDef"><span class="hs-identifier hs-type">pConcMethodDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Parser.AST.html#ConcMethodDef"><span class="hs-identifier hs-type">ConcMethodDef</span></a></span><span>
</span><span id="line-397"></span><span id="pConcMethodDef"><span class="annot"><span class="annottext">pConcMethodDef :: [Token] -&gt; Either (ParseErrorBundle [Token] Void) ConcMethodDef
</span><a href="Parser.Parser.html#pConcMethodDef"><span class="hs-identifier hs-var hs-var">pConcMethodDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] ConcMethodDef
-&gt; String
-&gt; [Token]
-&gt; Either (ParseErrorBundle [Token] Void) ConcMethodDef
forall e s a.
Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] ConcMethodDef
</span><a href="Parser.Parser.html#parseConcMethodDef"><span class="hs-identifier hs-var">parseConcMethodDef</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="annot"><span class="hs-comment">-- | Parse a top-level function definition from a list of tokens.</span></span><span>
</span><span id="line-400"></span><span class="annot"><a href="Parser.Parser.html#pFuncDef"><span class="hs-identifier hs-type">pFuncDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Parser.AST.html#FuncDef"><span class="hs-identifier hs-type">FuncDef</span></a></span><span>
</span><span id="line-401"></span><span id="pFuncDef"><span class="annot"><span class="annottext">pFuncDef :: [Token] -&gt; Either (ParseErrorBundle [Token] Void) FuncDef
</span><a href="Parser.Parser.html#pFuncDef"><span class="hs-identifier hs-var hs-var">pFuncDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] FuncDef
-&gt; String
-&gt; [Token]
-&gt; Either (ParseErrorBundle [Token] Void) FuncDef
forall e s a.
Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] FuncDef
</span><a href="Parser.Parser.html#parseFuncDef"><span class="hs-identifier hs-var">parseFuncDef</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="annot"><span class="hs-comment">-- | Parse a ProgramItem from a list of tokens.</span></span><span>
</span><span id="line-404"></span><span class="annot"><a href="Parser.Parser.html#pProgramItem"><span class="hs-identifier hs-type">pProgramItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Parser.AST.html#ProgramItem"><span class="hs-identifier hs-type">ProgramItem</span></a></span><span>
</span><span id="line-405"></span><span id="pProgramItem"><span class="annot"><span class="annottext">pProgramItem :: [Token] -&gt; Either (ParseErrorBundle [Token] Void) ProgramItem
</span><a href="Parser.Parser.html#pProgramItem"><span class="hs-identifier hs-var hs-var">pProgramItem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] ProgramItem
-&gt; String
-&gt; [Token]
-&gt; Either (ParseErrorBundle [Token] Void) ProgramItem
forall e s a.
Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] ProgramItem
</span><a href="Parser.Parser.html#parseProgramItem"><span class="hs-identifier hs-var">parseProgramItem</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="annot"><span class="hs-comment">-- | Parse an entire Program from a list of tokens.</span></span><span>
</span><span id="line-408"></span><span class="annot"><a href="Parser.Parser.html#pProgram"><span class="hs-identifier hs-type">pProgram</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Tokenizer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Parser.AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span>
</span><span id="line-409"></span><span id="pProgram"><span class="annot"><span class="annottext">pProgram :: [Token] -&gt; Either (ParseErrorBundle [Token] Void) Program
</span><a href="Parser.Parser.html#pProgram"><span class="hs-identifier hs-var hs-var">pProgram</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] Program
-&gt; String
-&gt; [Token]
-&gt; Either (ParseErrorBundle [Token] Void) Program
forall e s a.
Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] Program
</span><a href="Parser.Parser.html#parseProgram"><span class="hs-identifier hs-var">parseProgram</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- Trait / Method / Struct / Implementation Parsers</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="annot"><span class="hs-comment">-- | check if Identifier 'token' for  struct name.</span></span><span>
</span><span id="line-415"></span><span class="annot"><a href="Parser.Parser.html#pIdentifier"><span class="hs-identifier hs-type">pIdentifier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-416"></span><span id="pIdentifier"><span class="annot"><span class="annottext">pIdentifier :: ParsecT Void [Token] Identity String
</span><a href="Parser.Parser.html#pIdentifier"><span class="hs-identifier hs-var hs-var">pIdentifier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-417"></span><span>  </span><span id="local-6989586621679077717"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077717"><span class="hs-identifier hs-var">tok</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Token [Token] -&gt; Bool)
-&gt; ParsecT Void [Token] Identity (Token [Token])
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Bool
Token [Token] -&gt; Bool
</span><a href="Parser.Parser.html#isIdentifierToken"><span class="hs-identifier hs-var">isIdentifierToken</span></a></span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679077717"><span class="hs-identifier hs-var">tok</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-419"></span><span>    </span><span class="annot"><a href="Tokenizer.Token.html#IdentifierToken"><span class="hs-identifier hs-type">IdentifierToken</span></a></span><span> </span><span id="local-6989586621679077718"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077718"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void [Token] Identity String
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077718"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-420"></span><span>    </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void [Token] Identity String
forall a. String -&gt; ParsecT Void [Token] Identity a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected identifier&quot;</span></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="annot"><span class="hs-comment">-- | Parse a struct name.</span></span><span>
</span><span id="line-423"></span><span class="annot"><a href="Parser.Parser.html#pAtomStructActualParam"><span class="hs-identifier hs-type">pAtomStructActualParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#StructActualParam"><span class="hs-identifier hs-type">StructActualParam</span></a></span><span>
</span><span id="line-424"></span><span id="pAtomStructActualParam"><span class="annot"><span class="annottext">pAtomStructActualParam :: Parser StructActualParam
</span><a href="Parser.Parser.html#pAtomStructActualParam"><span class="hs-identifier hs-var hs-var">pAtomStructActualParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-425"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Expr -&gt; StructActualParam
</span><a href="Parser.AST.html#StructActualParam"><span class="hs-identifier hs-var">StructActualParam</span></a></span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; Expr -&gt; StructActualParam)
-&gt; ParsecT Void [Token] Identity String
-&gt; ParsecT Void [Token] Identity (Expr -&gt; StructActualParam)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Token [Token] -&gt; Bool)
-&gt; ParsecT Void [Token] Identity (Token [Token])
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Bool
Token [Token] -&gt; Bool
</span><a href="Parser.Parser.html#isIdentifierToken"><span class="hs-identifier hs-var">isIdentifierToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token
-&gt; (Token -&gt; ParsecT Void [Token] Identity String)
-&gt; ParsecT Void [Token] Identity String
forall a b.
ParsecT Void [Token] Identity a
-&gt; (a -&gt; ParsecT Void [Token] Identity b)
-&gt; ParsecT Void [Token] Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Tokenizer.Token.html#IdentifierToken"><span class="hs-identifier hs-type">IdentifierToken</span></a></span><span> </span><span id="local-6989586621679077721"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077721"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void [Token] Identity String
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077721"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Expr -&gt; StructActualParam)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity (Expr -&gt; StructActualParam)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ColonToken"><span class="hs-identifier hs-var">ColonToken</span></a></span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Expr -&gt; StructActualParam)
-&gt; Parser Expr -&gt; Parser StructActualParam
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Expr
</span><a href="Parser.Parser.html#pExpr"><span class="hs-identifier hs-var">pExpr</span></a></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span class="annot"><span class="hs-comment">-- | Parse a single struct actual parameter.</span></span><span>
</span><span id="line-431"></span><span class="annot"><a href="Parser.Parser.html#pStructActualParam"><span class="hs-identifier hs-type">pStructActualParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#StructActualParam"><span class="hs-identifier hs-type">StructActualParam</span></a></span><span>
</span><span id="line-432"></span><span id="pStructActualParam"><span class="annot"><span class="annottext">pStructActualParam :: Parser StructActualParam
</span><a href="Parser.Parser.html#pStructActualParam"><span class="hs-identifier hs-var hs-var">pStructActualParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser StructActualParam -&gt; Parser StructActualParam
forall a.
ParsecT Void [Token] Identity a -&gt; ParsecT Void [Token] Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">Parser StructActualParam
</span><a href="Parser.Parser.html#pAtomStructActualParam"><span class="hs-identifier hs-var">pAtomStructActualParam</span></a></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="annot"><span class="hs-comment">-- | Parse a comma-separated list of struct actual parameters.</span></span><span>
</span><span id="line-435"></span><span class="annot"><a href="Parser.Parser.html#pStructActualParams"><span class="hs-identifier hs-type">pStructActualParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Parser.AST.html#StructActualParam"><span class="hs-identifier hs-type">StructActualParam</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-436"></span><span id="pStructActualParams"><span class="annot"><span class="annottext">pStructActualParams :: Parser [StructActualParam]
</span><a href="Parser.Parser.html#pStructActualParams"><span class="hs-identifier hs-var hs-var">pStructActualParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[StructActualParam]
-&gt; Parser [StructActualParam] -&gt; Parser [StructActualParam]
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Parser [StructActualParam] -&gt; Parser [StructActualParam])
-&gt; Parser [StructActualParam] -&gt; Parser [StructActualParam]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-437"></span><span>  </span><span id="local-6989586621679077723"><span class="annot"><span class="annottext">StructActualParam
</span><a href="#local-6989586621679077723"><span class="hs-identifier hs-var">firstParam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser StructActualParam
</span><a href="Parser.Parser.html#pAtomStructActualParam"><span class="hs-identifier hs-var">pAtomStructActualParam</span></a></span><span>
</span><span id="line-438"></span><span>  </span><span id="local-6989586621679077724"><span class="annot"><span class="annottext">[StructActualParam]
</span><a href="#local-6989586621679077724"><span class="hs-identifier hs-var">restParams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser StructActualParam -&gt; Parser [StructActualParam]
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#CommaToken"><span class="hs-identifier hs-var">CommaToken</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token
-&gt; Parser StructActualParam -&gt; Parser StructActualParam
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser StructActualParam
</span><a href="Parser.Parser.html#pAtomStructActualParam"><span class="hs-identifier hs-var">pAtomStructActualParam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>  </span><span class="annot"><span class="annottext">[StructActualParam] -&gt; Parser [StructActualParam]
forall a. a -&gt; ParsecT Void [Token] Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StructActualParam
</span><a href="#local-6989586621679077723"><span class="hs-identifier hs-var">firstParam</span></a></span><span> </span><span class="annot"><span class="annottext">StructActualParam -&gt; [StructActualParam] -&gt; [StructActualParam]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[StructActualParam]
</span><a href="#local-6989586621679077724"><span class="hs-identifier hs-var">restParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="annot"><span class="hs-comment">-- | Parse a trait definition.</span></span><span>
</span><span id="line-442"></span><span class="annot"><a href="Parser.Parser.html#parseTraitDef"><span class="hs-identifier hs-type">parseTraitDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#TraitDef"><span class="hs-identifier hs-type">TraitDef</span></a></span><span>
</span><span id="line-443"></span><span id="parseTraitDef"><span class="annot"><span class="annottext">parseTraitDef :: Parsec Void [Token] TraitDef
</span><a href="Parser.Parser.html#parseTraitDef"><span class="hs-identifier hs-var hs-var">parseTraitDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [AbsMethodDef] -&gt; TraitDef
</span><a href="Parser.AST.html#TraitDef"><span class="hs-identifier hs-var">TraitDef</span></a></span><span>
</span><span id="line-445"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; [AbsMethodDef] -&gt; TraitDef)
-&gt; Parser Token
-&gt; ParsecT
     Void [Token] Identity (String -&gt; [AbsMethodDef] -&gt; TraitDef)
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#TraitToken"><span class="hs-identifier hs-var">TraitToken</span></a></span><span>
</span><span id="line-446"></span><span>    </span><span class="annot"><span class="annottext">ParsecT
  Void [Token] Identity (String -&gt; [AbsMethodDef] -&gt; TraitDef)
-&gt; ParsecT Void [Token] Identity String
-&gt; ParsecT Void [Token] Identity ([AbsMethodDef] -&gt; TraitDef)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity String
</span><a href="Parser.Parser.html#pIdentifier"><span class="hs-identifier hs-var">pIdentifier</span></a></span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity ([AbsMethodDef] -&gt; TraitDef)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity ([AbsMethodDef] -&gt; TraitDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LBraceToken"><span class="hs-identifier hs-var">LBraceToken</span></a></span><span>
</span><span id="line-448"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity ([AbsMethodDef] -&gt; TraitDef)
-&gt; ParsecT Void [Token] Identity [AbsMethodDef]
-&gt; Parsec Void [Token] TraitDef
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] AbsMethodDef
-&gt; ParsecT Void [Token] Identity [AbsMethodDef]
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] AbsMethodDef
</span><a href="Parser.Parser.html#parseAbsMethodDef"><span class="hs-identifier hs-var">parseAbsMethodDef</span></a></span><span>
</span><span id="line-449"></span><span>    </span><span class="annot"><span class="annottext">Parsec Void [Token] TraitDef
-&gt; Parser Token -&gt; Parsec Void [Token] TraitDef
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RBraceToken"><span class="hs-identifier hs-var">RBraceToken</span></a></span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="annot"><span class="hs-comment">-- | Parse an abstract method definition.</span></span><span>
</span><span id="line-452"></span><span class="annot"><a href="Parser.Parser.html#parseAbsMethodDef"><span class="hs-identifier hs-type">parseAbsMethodDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#AbsMethodDef"><span class="hs-identifier hs-type">AbsMethodDef</span></a></span><span>
</span><span id="line-453"></span><span id="parseAbsMethodDef"><span class="annot"><span class="annottext">parseAbsMethodDef :: Parsec Void [Token] AbsMethodDef
</span><a href="Parser.Parser.html#parseAbsMethodDef"><span class="hs-identifier hs-var hs-var">parseAbsMethodDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [Param] -&gt; Type -&gt; AbsMethodDef
</span><a href="Parser.AST.html#AbsMethodDef"><span class="hs-identifier hs-var">AbsMethodDef</span></a></span><span>
</span><span id="line-455"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; [Param] -&gt; Type -&gt; AbsMethodDef)
-&gt; Parser Token
-&gt; ParsecT
     Void [Token] Identity (String -&gt; [Param] -&gt; Type -&gt; AbsMethodDef)
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#MethodToken"><span class="hs-identifier hs-var">MethodToken</span></a></span><span>
</span><span id="line-456"></span><span>    </span><span class="annot"><span class="annottext">ParsecT
  Void [Token] Identity (String -&gt; [Param] -&gt; Type -&gt; AbsMethodDef)
-&gt; ParsecT Void [Token] Identity String
-&gt; ParsecT Void [Token] Identity ([Param] -&gt; Type -&gt; AbsMethodDef)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity String
</span><a href="Parser.Parser.html#pIdentifier"><span class="hs-identifier hs-var">pIdentifier</span></a></span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity ([Param] -&gt; Type -&gt; AbsMethodDef)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity ([Param] -&gt; Type -&gt; AbsMethodDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LParenToken"><span class="hs-identifier hs-var">LParenToken</span></a></span><span>
</span><span id="line-458"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity ([Param] -&gt; Type -&gt; AbsMethodDef)
-&gt; Parser [Param]
-&gt; ParsecT Void [Token] Identity (Type -&gt; AbsMethodDef)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser [Param]
</span><a href="Parser.Parser.html#pCommaParam"><span class="hs-identifier hs-var">pCommaParam</span></a></span><span>
</span><span id="line-459"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Type -&gt; AbsMethodDef)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity (Type -&gt; AbsMethodDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RParenToken"><span class="hs-identifier hs-var">RParenToken</span></a></span><span>
</span><span id="line-460"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Type -&gt; AbsMethodDef)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity (Type -&gt; AbsMethodDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ColonToken"><span class="hs-identifier hs-var">ColonToken</span></a></span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Type -&gt; AbsMethodDef)
-&gt; Parser Type -&gt; Parsec Void [Token] AbsMethodDef
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pType"><span class="hs-identifier hs-var">pType</span></a></span><span>
</span><span id="line-462"></span><span>    </span><span class="annot"><span class="annottext">Parsec Void [Token] AbsMethodDef
-&gt; Parser Token -&gt; Parsec Void [Token] AbsMethodDef
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#SemiColonToken"><span class="hs-identifier hs-var">SemiColonToken</span></a></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span class="annot"><span class="hs-comment">-- | Parse a struct definition.</span></span><span>
</span><span id="line-465"></span><span class="annot"><a href="Parser.Parser.html#parseStructDef"><span class="hs-identifier hs-type">parseStructDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#StructDef"><span class="hs-identifier hs-type">StructDef</span></a></span><span>
</span><span id="line-466"></span><span id="parseStructDef"><span class="annot"><span class="annottext">parseStructDef :: Parsec Void [Token] StructDef
</span><a href="Parser.Parser.html#parseStructDef"><span class="hs-identifier hs-var hs-var">parseStructDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-467"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [Param] -&gt; StructDef
</span><a href="Parser.AST.html#StructDef"><span class="hs-identifier hs-var">StructDef</span></a></span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; [Param] -&gt; StructDef)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity (String -&gt; [Param] -&gt; StructDef)
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#StructToken"><span class="hs-identifier hs-var">StructToken</span></a></span><span>
</span><span id="line-469"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (String -&gt; [Param] -&gt; StructDef)
-&gt; ParsecT Void [Token] Identity String
-&gt; ParsecT Void [Token] Identity ([Param] -&gt; StructDef)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity String
</span><a href="Parser.Parser.html#pIdentifier"><span class="hs-identifier hs-var">pIdentifier</span></a></span><span>
</span><span id="line-470"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity ([Param] -&gt; StructDef)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity ([Param] -&gt; StructDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LBraceToken"><span class="hs-identifier hs-var">LBraceToken</span></a></span><span>
</span><span id="line-471"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity ([Param] -&gt; StructDef)
-&gt; Parser [Param] -&gt; Parsec Void [Token] StructDef
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser [Param]
</span><a href="Parser.Parser.html#pCommaParam"><span class="hs-identifier hs-var">pCommaParam</span></a></span><span>
</span><span id="line-472"></span><span>    </span><span class="annot"><span class="annottext">Parsec Void [Token] StructDef
-&gt; Parser Token -&gt; Parsec Void [Token] StructDef
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RBraceToken"><span class="hs-identifier hs-var">RBraceToken</span></a></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="annot"><span class="hs-comment">-- | Parse an implementation definition.</span></span><span>
</span><span id="line-475"></span><span class="annot"><a href="Parser.Parser.html#parseImplDef"><span class="hs-identifier hs-type">parseImplDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#ImplDef"><span class="hs-identifier hs-type">ImplDef</span></a></span><span>
</span><span id="line-476"></span><span id="parseImplDef"><span class="annot"><span class="annottext">parseImplDef :: Parsec Void [Token] ImplDef
</span><a href="Parser.Parser.html#parseImplDef"><span class="hs-identifier hs-var hs-var">parseImplDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-477"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Type -&gt; [ConcMethodDef] -&gt; ImplDef
</span><a href="Parser.AST.html#ImplDef"><span class="hs-identifier hs-var">ImplDef</span></a></span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; Type -&gt; [ConcMethodDef] -&gt; ImplDef)
-&gt; Parser Token
-&gt; ParsecT
     Void
     [Token]
     Identity
     (String -&gt; Type -&gt; [ConcMethodDef] -&gt; ImplDef)
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ImplToken"><span class="hs-identifier hs-var">ImplToken</span></a></span><span>
</span><span id="line-479"></span><span>    </span><span class="annot"><span class="annottext">ParsecT
  Void
  [Token]
  Identity
  (String -&gt; Type -&gt; [ConcMethodDef] -&gt; ImplDef)
-&gt; ParsecT Void [Token] Identity String
-&gt; ParsecT
     Void [Token] Identity (Type -&gt; [ConcMethodDef] -&gt; ImplDef)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity String
</span><a href="Parser.Parser.html#pIdentifier"><span class="hs-identifier hs-var">pIdentifier</span></a></span><span>
</span><span id="line-480"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Type -&gt; [ConcMethodDef] -&gt; ImplDef)
-&gt; Parser Token
-&gt; ParsecT
     Void [Token] Identity (Type -&gt; [ConcMethodDef] -&gt; ImplDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ForToken"><span class="hs-identifier hs-var">ForToken</span></a></span><span>
</span><span id="line-481"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Type -&gt; [ConcMethodDef] -&gt; ImplDef)
-&gt; Parser Type
-&gt; ParsecT Void [Token] Identity ([ConcMethodDef] -&gt; ImplDef)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pType"><span class="hs-identifier hs-var">pType</span></a></span><span>
</span><span id="line-482"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity ([ConcMethodDef] -&gt; ImplDef)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity ([ConcMethodDef] -&gt; ImplDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LBraceToken"><span class="hs-identifier hs-var">LBraceToken</span></a></span><span>
</span><span id="line-483"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity ([ConcMethodDef] -&gt; ImplDef)
-&gt; ParsecT Void [Token] Identity [ConcMethodDef]
-&gt; Parsec Void [Token] ImplDef
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] ConcMethodDef
-&gt; ParsecT Void [Token] Identity [ConcMethodDef]
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] ConcMethodDef
</span><a href="Parser.Parser.html#parseConcMethodDef"><span class="hs-identifier hs-var">parseConcMethodDef</span></a></span><span>
</span><span id="line-484"></span><span>    </span><span class="annot"><span class="annottext">Parsec Void [Token] ImplDef
-&gt; Parser Token -&gt; Parsec Void [Token] ImplDef
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RBraceToken"><span class="hs-identifier hs-var">RBraceToken</span></a></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="annot"><span class="hs-comment">-- | Parse a concrete method definition.</span></span><span>
</span><span id="line-487"></span><span class="annot"><a href="Parser.Parser.html#parseConcMethodDef"><span class="hs-identifier hs-type">parseConcMethodDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#ConcMethodDef"><span class="hs-identifier hs-type">ConcMethodDef</span></a></span><span>
</span><span id="line-488"></span><span id="parseConcMethodDef"><span class="annot"><span class="annottext">parseConcMethodDef :: Parsec Void [Token] ConcMethodDef
</span><a href="Parser.Parser.html#parseConcMethodDef"><span class="hs-identifier hs-var hs-var">parseConcMethodDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-489"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [Param] -&gt; Type -&gt; [Stmt] -&gt; ConcMethodDef
</span><a href="Parser.AST.html#ConcMethodDef"><span class="hs-identifier hs-var">ConcMethodDef</span></a></span><span>
</span><span id="line-490"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; [Param] -&gt; Type -&gt; [Stmt] -&gt; ConcMethodDef)
-&gt; Parser Token
-&gt; ParsecT
     Void
     [Token]
     Identity
     (String -&gt; [Param] -&gt; Type -&gt; [Stmt] -&gt; ConcMethodDef)
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#MethodToken"><span class="hs-identifier hs-var">MethodToken</span></a></span><span>
</span><span id="line-491"></span><span>    </span><span class="annot"><span class="annottext">ParsecT
  Void
  [Token]
  Identity
  (String -&gt; [Param] -&gt; Type -&gt; [Stmt] -&gt; ConcMethodDef)
-&gt; ParsecT Void [Token] Identity String
-&gt; ParsecT
     Void [Token] Identity ([Param] -&gt; Type -&gt; [Stmt] -&gt; ConcMethodDef)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity String
</span><a href="Parser.Parser.html#pIdentifier"><span class="hs-identifier hs-var">pIdentifier</span></a></span><span>
</span><span id="line-492"></span><span>    </span><span class="annot"><span class="annottext">ParsecT
  Void [Token] Identity ([Param] -&gt; Type -&gt; [Stmt] -&gt; ConcMethodDef)
-&gt; Parser Token
-&gt; ParsecT
     Void [Token] Identity ([Param] -&gt; Type -&gt; [Stmt] -&gt; ConcMethodDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LParenToken"><span class="hs-identifier hs-var">LParenToken</span></a></span><span>
</span><span id="line-493"></span><span>    </span><span class="annot"><span class="annottext">ParsecT
  Void [Token] Identity ([Param] -&gt; Type -&gt; [Stmt] -&gt; ConcMethodDef)
-&gt; Parser [Param]
-&gt; ParsecT Void [Token] Identity (Type -&gt; [Stmt] -&gt; ConcMethodDef)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser [Param]
</span><a href="Parser.Parser.html#pCommaParam"><span class="hs-identifier hs-var">pCommaParam</span></a></span><span>
</span><span id="line-494"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Type -&gt; [Stmt] -&gt; ConcMethodDef)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity (Type -&gt; [Stmt] -&gt; ConcMethodDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RParenToken"><span class="hs-identifier hs-var">RParenToken</span></a></span><span>
</span><span id="line-495"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Type -&gt; [Stmt] -&gt; ConcMethodDef)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity (Type -&gt; [Stmt] -&gt; ConcMethodDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ColonToken"><span class="hs-identifier hs-var">ColonToken</span></a></span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Type -&gt; [Stmt] -&gt; ConcMethodDef)
-&gt; Parser Type
-&gt; ParsecT Void [Token] Identity ([Stmt] -&gt; ConcMethodDef)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pType"><span class="hs-identifier hs-var">pType</span></a></span><span>
</span><span id="line-497"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity ([Stmt] -&gt; ConcMethodDef)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity ([Stmt] -&gt; ConcMethodDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LBraceToken"><span class="hs-identifier hs-var">LBraceToken</span></a></span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity ([Stmt] -&gt; ConcMethodDef)
-&gt; ParsecT Void [Token] Identity [Stmt]
-&gt; Parsec Void [Token] ConcMethodDef
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt -&gt; ParsecT Void [Token] Identity [Stmt]
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pStmt"><span class="hs-identifier hs-var">pStmt</span></a></span><span>
</span><span id="line-499"></span><span>    </span><span class="annot"><span class="annottext">Parsec Void [Token] ConcMethodDef
-&gt; Parser Token -&gt; Parsec Void [Token] ConcMethodDef
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RBraceToken"><span class="hs-identifier hs-var">RBraceToken</span></a></span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span class="annot"><span class="hs-comment">-- | Parse a function definition.</span></span><span>
</span><span id="line-502"></span><span class="annot"><a href="Parser.Parser.html#parseFuncDef"><span class="hs-identifier hs-type">parseFuncDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#FuncDef"><span class="hs-identifier hs-type">FuncDef</span></a></span><span>
</span><span id="line-503"></span><span id="parseFuncDef"><span class="annot"><span class="annottext">parseFuncDef :: Parsec Void [Token] FuncDef
</span><a href="Parser.Parser.html#parseFuncDef"><span class="hs-identifier hs-var hs-var">parseFuncDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-504"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [Param] -&gt; Type -&gt; [Stmt] -&gt; FuncDef
</span><a href="Parser.AST.html#FuncDef"><span class="hs-identifier hs-var">FuncDef</span></a></span><span>
</span><span id="line-505"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; [Param] -&gt; Type -&gt; [Stmt] -&gt; FuncDef)
-&gt; Parser Token
-&gt; ParsecT
     Void
     [Token]
     Identity
     (String -&gt; [Param] -&gt; Type -&gt; [Stmt] -&gt; FuncDef)
forall a b.
a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#FuncToken"><span class="hs-identifier hs-var">FuncToken</span></a></span><span>
</span><span id="line-506"></span><span>    </span><span class="annot"><span class="annottext">ParsecT
  Void
  [Token]
  Identity
  (String -&gt; [Param] -&gt; Type -&gt; [Stmt] -&gt; FuncDef)
-&gt; ParsecT Void [Token] Identity String
-&gt; ParsecT
     Void [Token] Identity ([Param] -&gt; Type -&gt; [Stmt] -&gt; FuncDef)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity String
</span><a href="Parser.Parser.html#pIdentifier"><span class="hs-identifier hs-var">pIdentifier</span></a></span><span>
</span><span id="line-507"></span><span>    </span><span class="annot"><span class="annottext">ParsecT
  Void [Token] Identity ([Param] -&gt; Type -&gt; [Stmt] -&gt; FuncDef)
-&gt; Parser Token
-&gt; ParsecT
     Void [Token] Identity ([Param] -&gt; Type -&gt; [Stmt] -&gt; FuncDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LParenToken"><span class="hs-identifier hs-var">LParenToken</span></a></span><span>
</span><span id="line-508"></span><span>    </span><span class="annot"><span class="annottext">ParsecT
  Void [Token] Identity ([Param] -&gt; Type -&gt; [Stmt] -&gt; FuncDef)
-&gt; Parser [Param]
-&gt; ParsecT Void [Token] Identity (Type -&gt; [Stmt] -&gt; FuncDef)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser [Param]
</span><a href="Parser.Parser.html#pCommaParam"><span class="hs-identifier hs-var">pCommaParam</span></a></span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Type -&gt; [Stmt] -&gt; FuncDef)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity (Type -&gt; [Stmt] -&gt; FuncDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RParenToken"><span class="hs-identifier hs-var">RParenToken</span></a></span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Type -&gt; [Stmt] -&gt; FuncDef)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity (Type -&gt; [Stmt] -&gt; FuncDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#ColonToken"><span class="hs-identifier hs-var">ColonToken</span></a></span><span>
</span><span id="line-511"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity (Type -&gt; [Stmt] -&gt; FuncDef)
-&gt; Parser Type -&gt; ParsecT Void [Token] Identity ([Stmt] -&gt; FuncDef)
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Type
</span><a href="Parser.Parser.html#pType"><span class="hs-identifier hs-var">pType</span></a></span><span>
</span><span id="line-512"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity ([Stmt] -&gt; FuncDef)
-&gt; Parser Token
-&gt; ParsecT Void [Token] Identity ([Stmt] -&gt; FuncDef)
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#LBraceToken"><span class="hs-identifier hs-var">LBraceToken</span></a></span><span>
</span><span id="line-513"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity ([Stmt] -&gt; FuncDef)
-&gt; ParsecT Void [Token] Identity [Stmt]
-&gt; Parsec Void [Token] FuncDef
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt -&gt; ParsecT Void [Token] Identity [Stmt]
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pStmt"><span class="hs-identifier hs-var">pStmt</span></a></span><span>
</span><span id="line-514"></span><span>    </span><span class="annot"><span class="annottext">Parsec Void [Token] FuncDef
-&gt; Parser Token -&gt; Parsec Void [Token] FuncDef
forall a b.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
-&gt; ParsecT Void [Token] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
</span><a href="Parser.Parser.html#checkMatchingToken"><span class="hs-identifier hs-var">checkMatchingToken</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="Tokenizer.Token.html#RBraceToken"><span class="hs-identifier hs-var">RBraceToken</span></a></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="annot"><span class="hs-comment">-- | Parse a top-level program item.</span></span><span>
</span><span id="line-517"></span><span class="annot"><a href="Parser.Parser.html#parseProgramItem"><span class="hs-identifier hs-type">parseProgramItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#ProgramItem"><span class="hs-identifier hs-type">ProgramItem</span></a></span><span>
</span><span id="line-518"></span><span id="parseProgramItem"><span class="annot"><span class="annottext">parseProgramItem :: Parsec Void [Token] ProgramItem
</span><a href="Parser.Parser.html#parseProgramItem"><span class="hs-identifier hs-var hs-var">parseProgramItem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-519"></span><span>  </span><span class="annot"><span class="annottext">[Parsec Void [Token] ProgramItem]
-&gt; Parsec Void [Token] ProgramItem
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-520"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">StructDef -&gt; ProgramItem
</span><a href="Parser.AST.html#PI_Struct"><span class="hs-identifier hs-var">PI_Struct</span></a></span><span> </span><span class="annot"><span class="annottext">(StructDef -&gt; ProgramItem)
-&gt; Parsec Void [Token] StructDef -&gt; Parsec Void [Token] ProgramItem
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] StructDef
</span><a href="Parser.Parser.html#parseStructDef"><span class="hs-identifier hs-var">parseStructDef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-521"></span><span>      </span><span class="annot"><span class="annottext">TraitDef -&gt; ProgramItem
</span><a href="Parser.AST.html#PI_Trait"><span class="hs-identifier hs-var">PI_Trait</span></a></span><span> </span><span class="annot"><span class="annottext">(TraitDef -&gt; ProgramItem)
-&gt; Parsec Void [Token] TraitDef -&gt; Parsec Void [Token] ProgramItem
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] TraitDef
</span><a href="Parser.Parser.html#parseTraitDef"><span class="hs-identifier hs-var">parseTraitDef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-522"></span><span>      </span><span class="annot"><span class="annottext">ImplDef -&gt; ProgramItem
</span><a href="Parser.AST.html#PI_Impl"><span class="hs-identifier hs-var">PI_Impl</span></a></span><span> </span><span class="annot"><span class="annottext">(ImplDef -&gt; ProgramItem)
-&gt; Parsec Void [Token] ImplDef -&gt; Parsec Void [Token] ProgramItem
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] ImplDef
</span><a href="Parser.Parser.html#parseImplDef"><span class="hs-identifier hs-var">parseImplDef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-523"></span><span>      </span><span class="annot"><span class="annottext">FuncDef -&gt; ProgramItem
</span><a href="Parser.AST.html#PI_Func"><span class="hs-identifier hs-var">PI_Func</span></a></span><span> </span><span class="annot"><span class="annottext">(FuncDef -&gt; ProgramItem)
-&gt; Parsec Void [Token] FuncDef -&gt; Parsec Void [Token] ProgramItem
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] FuncDef
</span><a href="Parser.Parser.html#parseFuncDef"><span class="hs-identifier hs-var">parseFuncDef</span></a></span><span>
</span><span id="line-524"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span class="annot"><span class="hs-comment">-- | Parse an entire program consisting of program items and statements.</span></span><span>
</span><span id="line-527"></span><span class="annot"><a href="Parser.Parser.html#parseProgram"><span class="hs-identifier hs-type">parseProgram</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Parser.AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span>
</span><span id="line-528"></span><span id="parseProgram"><span class="annot"><span class="annottext">parseProgram :: Parsec Void [Token] Program
</span><a href="Parser.Parser.html#parseProgram"><span class="hs-identifier hs-var hs-var">parseProgram</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-529"></span><span>  </span><span class="annot"><span class="annottext">[ProgramItem] -&gt; [Stmt] -&gt; Program
</span><a href="Parser.AST.html#Program"><span class="hs-identifier hs-var">Program</span></a></span><span>
</span><span id="line-530"></span><span>    </span><span class="annot"><span class="annottext">([ProgramItem] -&gt; [Stmt] -&gt; Program)
-&gt; ParsecT Void [Token] Identity [ProgramItem]
-&gt; ParsecT Void [Token] Identity ([Stmt] -&gt; Program)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] ProgramItem
-&gt; ParsecT Void [Token] Identity [ProgramItem]
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void [Token] ProgramItem
</span><a href="Parser.Parser.html#parseProgramItem"><span class="hs-identifier hs-var">parseProgramItem</span></a></span><span>
</span><span id="line-531"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void [Token] Identity ([Stmt] -&gt; Program)
-&gt; ParsecT Void [Token] Identity [Stmt]
-&gt; Parsec Void [Token] Program
forall a b.
ParsecT Void [Token] Identity (a -&gt; b)
-&gt; ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt -&gt; ParsecT Void [Token] Identity [Stmt]
forall a.
ParsecT Void [Token] Identity a
-&gt; ParsecT Void [Token] Identity [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">Parser Stmt
</span><a href="Parser.Parser.html#pStmt"><span class="hs-identifier hs-var">pStmt</span></a></span><span>
</span><span id="line-532"></span></pre></body></html>